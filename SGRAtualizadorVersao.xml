<?xml version="1.0" standalone="yes"?>  <DATAPACKET Version="2.0"><METADATA><FIELDS><FIELD attrname="CODIGO" fieldtype="i4" readonly="true" SUBTYPE="Autoinc"/><FIELD attrname="DATA" fieldtype="date"/><FIELD attrname="SQL" fieldtype="bin.hex" SUBTYPE="Text" WIDTH="4000"/></FIELDS><PARAMS CHANGE_LOG="1 0 4 2 0 4 3 0 4 4 0 4 5 0 4 6 0 4 7 0 4 8 0 4 9 0 4 10 0 4 11 0 4 12 0 4 13 0 4 14 0 4 15 0 4 16 0 4 17 0 4 18 0 4 19 0 4 20 0 4 21 0 4 22 0 4 23 0 4 24 0 4 25 0 4 26 0 4 27 0 4 28 0 4 29 0 4 30 0 4 31 0 4 32 0 4 33 0 4 34 0 4 35 0 4 36 0 4 37 0 4 38 0 4 39 0 4 40 0 4 41 0 4 42 0 4 43 0 4 44 0 4 45 0 4 46 0 4 47 0 4 48 0 4 49 0 4 50 0 4 51 0 4 52 0 4 53 0 4 54 0 4 55 0 4 56 0 4 57 0 4 58 0 4 59 0 4 60 0 4 61 0 4 62 0 4 63 0 4 64 0 4 65 0 4 66 0 4 67 0 4 68 0 4 69 0 4 70 0 4 71 0 4 72 0 4 73 0 4 74 0 4 75 0 4 76 0 4 77 0 4 78 0 4 79 0 4 80 0 4 81 0 4 82 0 4 83 0 4 84 0 4 85 0 4 86 0 4 87 0 4 88 0 4 89 0 4 90 0 4 91 0 4 92 0 4 92 0 2 93 0 4 94 0 4 95 0 4 96 0 4 97 0 4 98 0 4 99 0 4 100 48 8 101 100 8 102 101 8 103 54 8 104 5 8 105 22 8 106 102 8 107 106 8 108 0 4 109 108 8 110 109 8 111 107 8 112 111 8 113 0 4 114 0 4 115 114 8 116 0 4 117 116 8 118 117 8 119 0 4 120 119 8 121 120 8 122 0 4 123 122 8 123 0 2 121 0 2 124 0 4 125 0 4 126 0 4 127 0 4 128 0 4 129 0 4 130 0 4 131 0 4 132 131 8 133 0 4 134 0 4 135 44 8 136 135 8 137 103 8 138 137 8 139 138 8 140 136 8 141 0 4 142 141 8 143 0 4 143 0 2 144 0 4 145 0 4 146 0 4 147 0 4 148 0 4 149 0 4 150 0 4 151 0 4 152 0 4 153 0 4 154 0 4 155 0 4 156 0 4 157 0 4 158 0 4 159 0 4 160 0 4 161 0 4 162 0 4 163 0 4 164 0 4 165 0 4 166 0 4 167 0 4 168 0 4 169 0 4 170 0 4 171 0 4 172 0 4 173 0 4 174 0 4 175 0 4 176 145 8 177 146 8 178 147 8 179 148 8 180 149 8 181 150 8 182 151 8 183 152 8 184 153 8 185 154 8 186 155 8 187 156 8 188 157 8 189 158 8 190 159 8 191 160 8 192 161 8 193 162 8 194 163 8 195 164 8 196 165 8 197 166 8 198 167 8 199 168 8 200 169 8 201 170 8 202 171 8 203 172 8 204 173 8 205 174 8 206 175 8 207 0 4 208 0 4 209 139 8 210 208 8 211 210 8 212 209 8 213 50 8 214 112 8 215 212 8 216 0 4 217 0 4 218 0 4 219 0 4 220 0 4 221 215 8 222 221 8 223 0 4 224 223 8 225 224 8 226 0 4 227 0 4 228 222 8 229 0 4 89 0 2 230 226 8 231 0 4 232 0 4 233 0 4 234 0 4 235 0 4 236 0 4 237 0 4 238 0 4 239 0 4 240 0 4 241 0 4 242 0 4 243 0 4 244 0 4 245 0 4 246 0 4 247 0 4 248 0 4 244 0 2 248 0 2 249 0 4 250 0 4 251 0 4 251 0 2 252 1 8 253 252 8 254 0 4 255 0 4 256 0 4 257 0 4 258 0 4 259 0 4 260 258 8 260 0 2 261 0 4 262 0 4 263 0 4 264 0 4 265 0 4 266 265 8 267 0 4 268 0 4 269 0 4 270 0 4 271 0 4 272 0 4 254 0 2 273 0 4 274 273 8 275 274 8 276 261 8 277 263 8 277 0 2 278 0 4 279 0 4 280 0 4 281 0 4 282 0 4 283 0 4 284 0 4 285 0 4 286 0 4 287 0 4 288 0 4 289 0 4 290 0 4 291 0 4 289 0 2 292 0 4 293 0 4 294 0 4 295 0 4 296 0 4 297 0 4 298 297 8 299 0 4 300 0 4 301 0 4 302 0 4 303 0 4 304 0 4 305 0 4 306 0 4 307 0 4 308 0 4 309 0 4 310 0 4 311 0 4 312 0 4 313 0 4 314 0 4 315 0 4 316 0 4 317 306 8 318 307 8 319 308 8 320 309 8 321 320 8 322 300 8 323 319 8 324 0 4 325 0 4 311 0 2 326 317 8 327 318 8 328 323 8 329 321 8 330 0 4 331 0 4 332 326 8 333 327 8 334 328 8 335 329 8 336 0 4 337 0 4 338 0 4 339 0 4 340 0 4 341 0 4 342 339 8 343 340 8 344 341 8 345 0 4 346 343 8 347 346 8 348 342 8 349 347 8 348 0 2 350 0 4 351 349 8 352 351 8 353 344 8 354 345 8 355 352 8 356 353 8 357 354 8 358 0 4 359 0 4 360 0 4 361 0 4 362 0 4 363 0 4 364 0 4 365 0 4 366 0 4 367 0 4 368 0 4 369 0 4 370 364 8 371 367 8 369 0 2 368 0 2 371 0 2 366 0 2 365 0 2 370 0 2 363 0 2 362 0 2 361 0 2 372 358 8 373 360 8 374 0 4 375 0 4 376 0 4 377 0 4 378 0 4 379 0 4 380 0 4 381 0 4 382 0 4 383 0 4 384 0 4 385 0 4 386 0 4 387 0 4 388 0 4 388 0 2 389 382 8 390 338 8 391 0 4 392 0 4 393 0 4 394 0 4 395 394 8 396 0 4 397 396 8 398 397 8 399 391 8 400 399 8 401 0 4" AUTOINCVALUE="283"/></METADATA><ROWDATA><ROW RowState="5" CODIGO="1" DATA="20140527" SQL="CREATE TABLE atualiza_campos (&#009;CAMPO VARCHAR(30) NOT NULL, ATUALIZAR VARCHAR(1) NOT NULL DEFAULT &quot;S&quot;, PRIMARY KEY (CAMPO) );"/><ROW RowState="4" CODIGO="2" DATA="20140527" SQL="CREATE TABLE IF NOT EXISTS `berechtigungen` (&#013;  `betreiber_vorgesetzte` DOUBLE NULL&#013;)&#013;COLLATE=&quot;latin1_swedish_ci&quot;&#013;ENGINE=InnoDB;"/><ROW RowState="4" CODIGO="3" DATA="20140527" SQL="CREATE TABLE IF NOT EXISTS `licenca` (                    &#013;`Codigo` int(10) NOT NULL AUTO_INCREMENT,                 &#013;`SerialNumberHD` varchar(255) DEFAULT NULL,               &#013;`NomeComputador` varchar(255) DEFAULT NULL,               &#013;`DataAtual` varchar(50) DEFAULT NULL,                     &#013;`DataFinal` varchar(50) DEFAULT NULL,                     &#013;PRIMARY KEY (`Codigo`),                                   &#013;UNIQUE KEY `SerialNumberHD` (`SerialNumberHD`)            &#013;)"/><ROW RowState="4" CODIGO="4" DATA="20140527" SQL="CREATE TABLE IF NOT EXISTS `emailmerketing` ( &#013;`CODIGO` INT(10) NOT NULL AUTO_INCREMENT,     &#013;`DATAHORAENVIO` DATETIME NULL DEFAULT NULL,   &#013;`SUCESSOS` INT(11) NULL DEFAULT NULL,         &#013;`FALHAS` INT(11) NULL DEFAULT NULL,           &#013;PRIMARY KEY (`CODIGO`));"/><ROW RowState="5" CODIGO="5" DATA="20140527" SQL="CREATE TABLE IF NOT EXISTS `ddds_diferentes` ( &#013;`CODIGO` INT(11) NOT NULL AUTO_INCREMENT, &#013;`CIDADE` VARCHAR(255) NULL DEFAULT NULL,&#013;`DDD` VARCHAR(255) NULL DEFAULT NULL, &#013;`USAR` ENUM(&quot;SIM&quot;,&quot;NÃO&quot;) NULL DEFAULT NULL, &#013;PRIMARY KEY (`CODIGO`), &#013;UNIQUE INDEX `CIDADE` (`CIDADE`, `DDD`) &#013;)"/><ROW RowState="4" CODIGO="6" DATA="20140527" SQL=" CREATE TABLE IF NOT EXISTS `propostas` ( &#013;   `CODIGO` INT(10) NULL AUTO_INCREMENT, &#013;   `LIGACAO` INT(10) NULL, &#013;   `VALOR` DOUBLE NULL, &#013;   PRIMARY KEY (`CODIGO`), &#013;   CONSTRAINT `FK_LIGACAO_PROPOSTA` FOREIGN KEY (`LIGACAO`) REFERENCES `campanhas_clientes` (`CODIGO`) ON UPDATE CASCADE ON DELETE SET NULL &#013; ) &#013; COLLATE=&quot;latin1_swedish_ci&quot;  &#013; ENGINE=InnoDB"/><ROW RowState="4" CODIGO="7" DATA="20140527" SQL="CREATE TABLE IF NOT EXISTS `excecoes_segmentos` ( &#013;  `CODIGO` INT(10) NOT NULL AUTO_INCREMENT, &#013;  `SEGMENTO` INT(10) NULL DEFAULT NULL, &#013;  PRIMARY KEY (`CODIGO`), &#013;  INDEX `FK_SEGMENTO_EXCECAO` (`SEGMENTO`), &#013;  UNIQUE INDEX `SEGMENTO` (`SEGMENTO`), &#013;  CONSTRAINT `FK_SEGMENTO_EXCECAO` FOREIGN KEY (`SEGMENTO`) REFERENCES `segmentos` (`CODIGO`) ON UPDATE CASCADE ON DELETE CASCADE &#013;) &#013;COLLATE=&quot;latin1_swedish_ci&quot; &#013;ENGINE=InnoDB"/><ROW RowState="4" CODIGO="8" DATA="20140527" SQL="CREATE TABLE IF NOT EXISTS `bloqueia_antigos` ( &#013;&#009;`BLOQUEAR` ENUM(&quot;SIM&quot;,&quot;NÃO&quot;) NOT NULL, &#013;  PRIMARY KEY (`BLOQUEAR`) &#013;  ) &#013;  COLLATE=&quot;latin1_swedish_ci&quot; &#013;  ENGINE=MyISAM"/><ROW RowState="4" CODIGO="9" DATA="20140527" SQL="   CREATE TABLE IF NOT EXISTS `alteracoes_clientes` (   &#013;&#009;`CODIGO` INT(10) NOT NULL AUTO_INCREMENT,  &#013;&#009;`DATAHORA` DATETIME NULL DEFAULT NULL,  &#013;&#009;`CAMPO` VARCHAR(255) NULL DEFAULT NULL,  &#013;&#009;`VALOR_ANTIGO` VARCHAR(255) NULL DEFAULT NULL,  &#013;&#009;`VALOR_NOVO` VARCHAR(255) NULL DEFAULT NULL,  &#013;&#009;`CODIGO_SGR` VARCHAR(255) NULL DEFAULT NULL,  &#013;&#009;`CODIGO_ERP` VARCHAR(255) NULL DEFAULT NULL,  &#013;&#009;PRIMARY KEY (`CODIGO`)  &#013; )  &#013; COLLATE=&quot;latin1_swedish_ci&quot; &#013; ENGINE=InnoDB  "/><ROW RowState="4" CODIGO="10" DATA="20140527" SQL=" CREATE TABLE IF NOT EXISTS `qualidade` ( &#013;   `CODIGO` INT(10) NOT NULL AUTO_INCREMENT, &#013;   `LIGACAO` INT(10) NULL DEFAULT NULL, &#013;   `QUALIDADE` ENUM(&quot;RUIM&quot;,&quot;MÉDIA&quot;,&quot;BOA&quot;) NULL DEFAULT &quot;MÉDIA&quot;, &#013;   PRIMARY KEY (`CODIGO`), &#013;  INDEX `FKLIGACAO` (`LIGACAO`), &#013;    CONSTRAINT `FKLIGACAO` FOREIGN KEY (`LIGACAO`) REFERENCES `campanhas_clientes` (`CODIGO`) ON UPDATE CASCADE ON DELETE CASCADE &#013; ) &#013; COLLATE=&quot;latin1_swedish_ci&quot; &#013; ENGINE=InnoDB; "/><ROW RowState="4" CODIGO="11" DATA="20140527" SQL="CREATE TABLE fone_digito &#013;(                          &#013;&#009;UF&#009;&#009; VARCHAR(2) NOT NULL, &#013;&#009;DDD &#009; VARCHAR(2) NOT NULL, &#013;&#009;DIGITO VARCHAR(2) NOT NULL, &#013;&#009;PRIMARY KEY (UF, DDD, DIGITO)&#013;);"/><ROW RowState="4" CODIGO="12" DATA="20140527" SQL="ALTER TABLE operadores ADD COLUMN BANCO VARCHAR(255) NOT NULL"/><ROW RowState="4" CODIGO="13" DATA="20140527" SQL="ALTER TABLE compras CHANGE COLUMN `DESCRICAO` `DESCRICAO` VARCHAR(60) NULL DEFAULT NULL AFTER `VALOR`,&#009;ADD COLUMN `FORMA_PGTO` VARCHAR(255) NULL AFTER `DESCRICAO`"/><ROW RowState="4" CODIGO="14" DATA="20140527" SQL="ALTER TABLE config_mail ADD COLUMN `SSL` ENUM(&quot;SIM&quot;,&quot;NÃO&quot;) NULL DEFAULT &quot;NÃO&quot; "/><ROW RowState="4" CODIGO="15" DATA="20140527" SQL="ALTER TABLE itens_compra&#009;ADD COLUMN DESCONTO DOUBLE NULL DEFAULT &quot;0&quot;"/><ROW RowState="4" CODIGO="16" DATA="20140527" SQL="ALTER TABLE parametros ADD COLUMN ASTERISK_SERVER VARCHAR(255) NULL DEFAULT NULL"/><ROW RowState="4" CODIGO="17" DATA="20140527" SQL="ALTER TABLE parametros ADD COLUMN ASTERISK_PORTA INT NULL DEFAULT NULL"/><ROW RowState="4" CODIGO="18" DATA="20140527" SQL="ALTER TABLE parametros ADD COLUMN ASTERISK_PROXY VARCHAR(255) NULL DEFAULT NULL"/><ROW RowState="4" CODIGO="19" DATA="20140527" SQL="ALTER TABLE parametros ADD COLUMN ATUALIZACAO_HORA TIME"/><ROW RowState="4" CODIGO="20" DATA="20140527" SQL="ALTER TABLE parametros ADD COLUMN ATUALIZACAO_TODODIA  varchar(1) NOT NULL DEFAULT &quot;N&quot;"/><ROW RowState="4" CODIGO="21" DATA="20140527" SQL="ALTER TABLE parametros ADD COLUMN DESLIGA_COMPUTADOR   varchar(1) NOT NULL DEFAULT &quot;N&quot;"/><ROW RowState="5" CODIGO="22" DATA="20140527" SQL="ALTER TABLE operadores ADD COLUMN ASTERISK_RAMAL VARCHAR(150) NULL DEFAULT NULL "/><ROW RowState="4" CODIGO="23" DATA="20140527" SQL="ALTER TABLE operadores ADD COLUMN ASTERISK_USERID VARCHAR(150) NULL DEFAULT NULL"/><ROW RowState="4" CODIGO="24" DATA="20140527" SQL="ALTER TABLE operadores ADD COLUMN ASTERISK_LOGIN VARCHAR(150) NULL DEFAULT NULL"/><ROW RowState="4" CODIGO="25" DATA="20140527" SQL="ALTER TABLE operadores ADD COLUMN ASTERISK_SENHA VARCHAR(150) NULL DEFAULT NULL"/><ROW RowState="4" CODIGO="26" DATA="20140527" SQL="ALTER TABLE clientes ADD COLUMN ATUALIZADOR ENUM(&quot;CADASTRO&quot;,&quot;ATUALIZAÇÃO&quot;) NULL DEFAULT &quot;ATUALIZAÇÃO&quot;"/><ROW RowState="4" CODIGO="27" DATA="20140527" SQL="ALTER TABLE resultados ADD COLUMN PROPOSTA ENUM(&quot;SIM&quot;,&quot;NAO&quot;) NULL DEFAULT &quot;NAO&quot;"/><ROW RowState="4" CODIGO="28" DATA="20140527" SQL="INSERT IGNORE INTO motivos_pausa (CODIGO, DESCRICAO, TEMPO_MAX_SEG) VALUES (999, &quot;SISTEMA&quot;, 1800)"/><ROW RowState="4" CODIGO="29" DATA="20140527" SQL="ALTER TABLE resultados ADD COLUMN FIDELIZARCOTACAO ENUM(&quot;SIM&quot;,&quot;NAO&quot;) NULL DEFAULT &quot;NAO&quot;"/><ROW RowState="4" CODIGO="30" DATA="20140527" SQL="ALTER TABLE `operadores` &#013; CHANGE COLUMN `NOME` `NOME` VARCHAR(255) NULL DEFAULT &quot;&quot; , &#013;  CHANGE COLUMN `LOGIN` `LOGIN` VARCHAR(255) NULL DEFAULT &quot;&quot; , &#013;  CHANGE COLUMN `EMAIL` `EMAIL` VARCHAR(255) NULL DEFAULT &quot;&quot; , &#013;  CHANGE COLUMN `SENHA` `SENHA` VARCHAR(255) NULL DEFAULT &quot;&quot; , &#013;  CHANGE COLUMN `CODIGO_ERP` `CODIGO_ERP` VARCHAR(255) NULL DEFAULT &quot;&quot; , &#013;  CHANGE COLUMN `CODTELEFONIA` `CODTELEFONIA` VARCHAR(255) NULL DEFAULT &quot;&quot; , &#013;  CHANGE COLUMN `ASTERISK_RAMAL` `ASTERISK_RAMAL` VARCHAR(255) NULL DEFAULT NULL , &#013;  CHANGE COLUMN `ASTERISK_USERID` `ASTERISK_USERID` VARCHAR(255) NULL DEFAULT NULL , &#013;  CHANGE COLUMN `ASTERISK_LOGIN` `ASTERISK_LOGIN` VARCHAR(255) NULL DEFAULT NULL , &#013;  CHANGE COLUMN `ASTERISK_SENHA` `ASTERISK_SENHA` VARCHAR(255) NULL DEFAULT NULL ;"/><ROW RowState="4" CODIGO="31" DATA="20140527" SQL="ALTER TABLE `compras` CHANGE COLUMN `CODIGO` `CODIGO` INT(11) NOT NULL AUTO_INCREMENT FIRST"/><ROW RowState="4" CODIGO="32" DATA="20140527" SQL="ALTER TABLE `itens_compra`  CHANGE COLUMN `CODIGO` `CODIGO` INT(11) NOT NULL AUTO_INCREMENT FIRST"/><ROW RowState="4" CODIGO="33" DATA="20140527" SQL="ALTER TABLE fones_campanha_cli ADD UNIQUE INDEX IDX_CLIENTE_FONE(CLIENTE, FONE)"/><ROW RowState="4" CODIGO="34" DATA="20140527" SQL="ALTER TABLE clientes ADD UNIQUE INDEX IDX_UNIQUE_COD_ERP (COD_ERP);"/><ROW RowState="4" CODIGO="35" DATA="20140527" SQL="ALTER TABLE `itens_compra` ADD UNIQUE INDEX `NOTA` (`NOTA`, `CODPROD`)"/><ROW RowState="4" CODIGO="36" DATA="20140527" SQL="ALTER TABLE compras ADD CONSTRAINT FKCLIENTE_COMPRA FOREIGN KEY (CLIENTE) REFERENCES clientes (CODIGO) ON UPDATE CASCADE ON DELETE CASCADE"/><ROW RowState="4" CODIGO="37" DATA="20140527" SQL="DROP TRIGGER IF EXISTS BI_ERP_NULL;"/><ROW RowState="4" CODIGO="38" DATA="20140527" SQL="CREATE TRIGGER BI_ERP_NULL BEFORE INSERT  &#013;   ON clientes FOR EACH ROW                 &#013;BEGIN                                       &#013;IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN              &#013;  SET NEW.COD_ERP = NULL;                   &#013;END IF;                                     &#013;  END;"/><ROW RowState="4" CODIGO="39" DATA="20140527" SQL="DROP TRIGGER IF EXISTS BU_ERP_NULL_ALTERACOES;"/><ROW RowState="4" CODIGO="40" DATA="20140527" SQL="CREATE TRIGGER `BU_ERP_NULL_ALTERACOES` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN                                                                                                      &#013;                                                                                                                                                                                                     &#013;IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN                                                                                                                                                                       &#013;  SET NEW.COD_ERP = NULL;                                                                                                                                                                            &#013;END IF;                                                                                                                                                                                              &#013;                                                                                                                                                                                                     &#013;IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`) VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP);&#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP);                                                                                                             &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP);                                                                                                                 &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP);                                                                                                         &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP);                                                                                                               &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP);                                                                                                                   &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP);                                                                                                                   &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP);                                                                                                                   &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP);                                                                                                                            &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP);                                                                                                    &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP);                                                                             &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP);                                                                             &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP);                                                                             &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP);                                                                                                                      &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP);                                                                                                                   &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP);      &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP);                     &#013;  END IF;                                                                                                                                                                                            &#013;                                                                                                                                                                                                     &#013;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`)                                                                              &#013;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP);                                                                                             &#013;  END IF;                                                                                                                                                                                            &#013;END IF;                                                                                                                                                                                              &#013; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;                                                                                                                                                                &#013; END;"/><ROW RowState="4" CODIGO="41" DATA="20140527" SQL="DROP PROCEDURE IF EXISTS PR_INSERE_FONES_CAMPANHAS"/><ROW RowState="4" CODIGO="42" DATA="20140527" SQL="CREATE PROCEDURE PR_INSERE_FONES_CAMPANHAS() &#013;BEGIN                &#013;                                            &#013;&#009;INSERT IGNORE INTO fones_campanha_cli    &#013;&#009;(CLIENTE,FONE,TIPO_CONTATO)              &#013;&#009;&#009;SELECT                                &#013;&#009;&#009;&#009;CODIGO,                            &#013;&#009;&#009;&#009;CONCAT(AREA1,FONE1),              &#013;&#009;&#009;&#009;&quot;CLIENTE&quot;                         &#013;&#009;&#009;FROM                                 &#013;&#009;&#009;&#009;clientes                          &#013;&#009;&#009;WHERE                                &#013;&#009;&#009;&#009;LENGTH(CONCAT(AREA1,FONE1)) &gt;= 10 &#013;&#009;&#009;UNION                                &#013;&#009;&#009;SELECT                               &#013;&#009;&#009;&#009;CODIGO,                           &#013;&#009;&#009;&#009;CONCAT(AREA2,FONE2),              &#013;&#009;&#009;&#009;&quot;CLIENTE&quot;                         &#013;&#009;&#009;FROM                                &#013;&#009;&#009;&#009;clientes                          &#013;&#009;&#009;WHERE                                &#013;&#009;&#009;&#009;LENGTH(CONCAT(AREA2,FONE2)) &gt;= 10 &#013;&#009;&#009;UNION                                &#013;&#009;&#009;SELECT                               &#013;&#009;&#009;&#009;CODIGO,                           &#013;&#009;&#009;&#009;CONCAT(AREA3,FONE3),              &#013;&#009;&#009;&#009;&quot;CLIENTE&quot;                         &#013;&#009;&#009;FROM                                 &#013;&#009;&#009;&#009;clientes                          &#013;&#009;&#009;WHERE                                &#013;&#009;&#009;&#009;LENGTH(CONCAT(AREA3,FONE3)) &gt;= 10; &#013;                   &#013;END;"/><ROW RowState="4" CODIGO="43" DATA="20140527" SQL="DROP PROCEDURE IF EXISTS PR_ORGANIZA_CAMPANHAS;"/><ROW RowState="5" CODIGO="44" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_CAMPANHAS() &#013;BEGIN&#013;&#009;UPDATE&#013;&#009;&#009;campanhas_clientes cc                                                                                                                 &#013;&#009;INNER JOIN                                                                                                                               &#013;&#009;&#009;clientes cli ON (cc.CLIENTE = cli.CODIGO)                                                                                             &#013;&#009;SET&#013;&#009;&#009;&#009;cc.CAMPANHA = @cc := &#013;&#009;&#009;&#009;&#009;if&#013;&#009;&#009;&#009;&#009;&#009;(                                                                                                                            &#013;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA                                                                                                       &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;BETWEEN DATE_SUB(now(), INTERVAL(SELECT INATIVOS_RECENTES FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY)       &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;AND NOW(),                                                                                                             &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO) FROM campanhas c WHERE c.UNIDADE = cli.COD_UNIDADE),                                            &#013;&#009;&#009;&#009;&#009;&#009;IF                                                                                                                           &#013;&#009;&#009;&#009;&#009;&#009;&#009;( &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA                                                                                                    &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;BETWEEN DATE_SUB(NOW(),INTERVAL (SELECT INATIVOS_ANTIGOS FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY)     &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;AND DATE_SUB(now(),INTERVAL (SELECT INATIVOS_RECENTES FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY),       &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)+1 FROM campanhas c where c.UNIDADE = cli.COD_UNIDADE),                                       &#013;&#009;&#009;&#009;&#009;&#009;&#009;IF                                                                                                                        &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(                                                                                                                      &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA IS NULL,                                                                                        &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO) FROM campanhas c WHERE c.UNIDADE=cli.COD_UNIDADE),                                           &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)-1 FROM campanhas c WHERE c.UNIDADE = cli.COD_UNIDADE)                                        &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;)                                                                                                                      &#013;&#009;&#009;&#009;&#009;&#009;&#009;)                                                                                                                         &#013;&#009;&#009;&#009;&#009;&#009;),                                                                                                                           &#013;&#009;&#009;cli.COD_CAMPANHA = @cc                                                                                                                &#013;&#009;WHERE                                                                                                                                    &#013;&#009;&#009;cli.COD_UNIDADE &gt; 0                                                                                                                   &#013;&#009;&#009;AND cc.CONCLUIDO = &quot;NAO&quot;;                                                                                                             &#013;                                                                                                                                           &#013;END;"/><ROW RowState="4" CODIGO="45" DATA="20140527" SQL="DROP PROCEDURE IF EXISTS PR_REMOVE_AGENDAMENTOS_DUPLICADOS;"/><ROW RowState="4" CODIGO="46" DATA="20140527" SQL="CREATE PROCEDURE PR_REMOVE_AGENDAMENTOS_DUPLICADOS()                                                  &#013;BEGIN                                                                                                            &#013;  DECLARE VQTD INT;                                                                                              &#013;  DECLARE SAI INT DEFAULT 0;                                                                                     &#013;  DECLARE VLIGACOES VARCHAR(2000);                                                                               &#013;  DECLARE C_CAMPCLI CURSOR FOR                                                                                   &#013;&#009;&#009;(SELECT                                                                                                    &#013;&#009;&#009;&#009;COUNT(1) QTD,                                                                                           &#013;&#009;&#009;&#009;GROUP_CONCAT(CODIGO) LIGACOES                                                                           &#013;&#009;&#009;FROM                                                                                                       &#013;&#009;&#009;&#009;campanhas_clientes                                                                                      &#013;&#009;&#009;WHERE                                                                                                      &#013;&#009;&#009;&#009;CONCLUIDO = &quot;NAO&quot;                                                                                       &#013;&#009;&#009;GROUP BY                                                                                                   &#013;&#009;&#009;&#009;CLIENTE                                                                                                 &#013;&#009;&#009;HAVING                                                                                                     &#013;&#009;&#009;&#009;QTD &gt; 1);                                                                                               &#013;  DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;                                                            &#013;                                                                                                                 &#013;  OPEN C_CAMPCLI;                                                                                                &#013;                                                                                                                 &#013;&#009;L:LOOP                                                                                                       &#013;&#009;&#009;FETCH C_CAMPCLI INTO VQTD, VLIGACOES;&#009;                                                                    &#013;      IF SAI = 1 THEN                                                                                            &#013;         LEAVE L;                                                                                                &#013;      END IF;                                                                                                    &#013;      SET @VQTD = VQTD-1;                                                                                        &#013;      SET @VLIGACOES = VLIGACOES;                                                                                &#013;      SET @VSQL = CONCAT(&quot; DELETE FROM campanhas_clientes WHERE CODIGO IN (&quot;,@VLIGACOES,&quot;)LIMIT &quot;,@VQTD);     &#013;                                                                                                                 &#013;      PREPARE T FROM @VSQL;&#009;                                                                                   &#013; &#009;&#009;EXECUTE T;                                                                                                 &#013;                                                                                                                 &#013;&#009;END LOOP L;                                                                                                   &#013;  CLOSE C_CAMPCLI;                                                                                               &#013;END;"/><ROW RowState="4" CODIGO="47" DATA="20140527" SQL="DROP PROCEDURE IF EXISTS PR_REPOE_LIGACOES_FIDELIZADAS;"/><ROW RowState="5" CODIGO="48" DATA="20140527" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS()                 &#013;BEGIN                                                                       &#013;  DECLARE VCLIENTE,VOPERADOR INT;                                           &#013;  DECLARE SAI,SAI2 INT DEFAULT 0;                                           &#013;  DECLARE VFIDELIZA VARCHAR(3);                                             &#013;  DECLARE C_CLIENTE CURSOR FOR                                              &#013;&#009;&#009;(SELECT                                                                &#013;&#009;&#009;&#009;&#009;cli.CODIGO                                                       &#013;&#009;&#009;&#009;FROM                                                                &#013;&#009;&#009;&#009;&#009;clientes cli,                                                    &#013;&#009;&#009;&#009;&#009;campanhas_clientes cc,                                           &#013;&#009;&#009;&#009;&#009;resultados r                                                     &#013;&#009;&#009;&#009;WHERE                                                               &#013;&#009;&#009;&#009;&#009;cc.CLIENTE = cli.CODIGO                                          &#013;&#009;&#009;&#009;&#009;AND r.FIDELIZARCOTACAO = &quot;SIM&quot;                                   &#013;&#009;&#009;&#009;&#009;AND cli.OPERADOR &lt;&gt; -2                                           &#013;&#009;&#009;&#009;&#009;AND r.CODIGO = cc.RESULTADO                                      &#013;&#009;&#009;&#009;GROUP BY                                                            &#013;&#009;&#009;&#009;&#009;cli.CODIGO);                                                     &#013;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI2 = 1;                       &#013;   OPEN C_CLIENTE;                                                           &#013;   C_CLIENTE_LOOP:LOOP                                                       &#013;&#009;FETCH C_CLIENTE INTO VCLIENTE;                                            &#013;   BEGIN                                                                    &#013;                                                                            &#013;     DECLARE C_FIDELIZA CURSOR FOR                                          &#013;&#009;&#009;&#009;(SELECT                                                             &#013;&#009;      &#009;r.FIDELIZARCOTACAO,                                              &#013;&#009;      &#009;cc.OPERADOR_LIGACAO                                               &#013;&#009;      FROM                                                                &#013;&#009;      &#009;campanhas_clientes cc,                                           &#013;&#009;      &#009;resultados r                                                     &#013;&#009;      WHERE                                                               &#013;&#009;      &#009;r.CODIGO = cc.RESULTADO                                          &#013;&#009;       &#009;AND cc.CLIENTE = VCLIENTE                                        &#013;&#009;      ORDER BY                                                             &#013;&#009;      &#009;cc.DATA_HORA_LIG DESC                                             &#013;&#009;      LIMIT 5);                                                           &#013;&#009;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;                    &#013;                                                                            &#013;                                                                            &#013;&#009;&#009;  OPEN C_FIDELIZA;                                                     &#013;                                                                            &#013;&#009;&#009;&#009;C_FIDELIZA_LOOP:LOOP                                                &#013;&#009;&#009;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;                      &#013;&#009;&#009;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN                                        &#013;&#009;&#009;&#009;&#009;&#009;UPDATE                                                        &#013;&#009;&#009;&#009;&#009;&#009;&#009;campanhas_clientes                                         &#013;&#009;&#009;&#009;&#009;&#009;SET                                                           &#013;&#009;&#009;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR                                       &#013;&#009;&#009;&#009;&#009;&#009;WHERE                                                         &#013;&#009;&#009;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE                                         &#013;&#009;&#009;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot;                                      &#013;&#009;&#009;&#009;&#009;&#009;ORDER BY                                                      &#013;&#009;&#009;&#009;&#009;&#009;&#009;CODIGO DESC                                                &#013;&#009;&#009;&#009;&#009;&#009;LIMIT 1;                                                      &#013;&#009;&#009;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;                                        &#013;&#009;&#009;&#009;&#009;END IF;                                                          &#013;&#009;&#009;&#009;&#009;IF SAI = 1 THEN                                                  &#013;&#009;&#009;         &#009;LEAVE C_FIDELIZA_LOOP;                                     &#013;&#009;&#009;      END IF;                                                          &#013;&#009;&#009;&#009;END LOOP C_FIDELIZA_LOOP;                                           &#013;&#009;&#009;   CLOSE C_FIDELIZA;                                                   &#013;                                                                            &#013;   END;                                                                     &#013;   IF SAI2 = 1 THEN                                                         &#013;&#009;   LEAVE C_CLIENTE_LOOP;                                                  &#013;&#009;END IF;                                                                   &#013;&#009;END LOOP C_CLIENTE_LOOP;                                                  &#013;&#009;CLOSE C_CLIENTE;                                                          &#013;END;                                                                          "/><ROW RowState="4" CODIGO="49" DATA="20140527" SQL="DROP PROCEDURE IF EXISTS PR_REPOE_LIGACOES_FIDELIZADAS_FINALIZA;"/><ROW RowState="5" CODIGO="50" DATA="20140527" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS_FINALIZA(IN VCLIENTE INT, VOPERADOR INT) &#013;BEGIN                                                            &#013;  DECLARE SAI INT DEFAULT 0;                                     &#013;  DECLARE VFIDELIZA VARCHAR(3);                                  &#013;  DECLARE C_FIDELIZA CURSOR FOR                                  &#013;&#009;&#009;(SELECT                                                    &#013;      &#009;r.FIDELIZARCOTACAO                                     &#013;      FROM                                                       &#013;      &#009;campanhas_clientes cc,                                  &#013;      &#009;resultados r                                            &#013;      WHERE                                                      &#013;      &#009;r.CODIGO = cc.RESULTADO                                 &#013;       &#009;AND cc.CLIENTE = VCLIENTE                               &#013;      ORDER BY                                                   &#013;      &#009;cc.DATA_HORA_LIG DESC                                   &#013;      LIMIT 5);                                                  &#013;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;           &#013;                                                                 &#013;  OPEN C_FIDELIZA;                                               &#013;                                                                 &#013;&#009;C_FIDELIZA_LOOP:LOOP                                          &#013;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA;&#009;              &#013;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN                                  &#013;&#009;&#009;&#009;UPDATE                                                  &#013;&#009;&#009;&#009;&#009;campanhas_clientes                                   &#013;&#009;&#009;&#009;SET                                                     &#013;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR                                 &#013;&#009;&#009;&#009;WHERE                                                   &#013;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE                                   &#013;&#009;&#009;&#009;ORDER BY                                                &#013;&#009;&#009;&#009;&#009;CODIGO DESC                                          &#013;&#009;&#009;&#009;LIMIT 1;                                                &#013;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;                                  &#013;&#009;&#009;END IF;                                                    &#013;&#009;&#009;IF SAI = 1 THEN                                            &#013;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;                            &#013;      &#009;&#009;END IF;&#009;&#009;                                         &#013;&#009;END LOOP C_FIDELIZA_LOOP;                                     &#013;  CLOSE C_FIDELIZA;                                              &#013;END;                                                                      "/><ROW RowState="4" CODIGO="51" DATA="20140527" SQL="DROP PROCEDURE IF EXISTS PR_REPOE_LIGACOES_PERDIDAS;"/><ROW RowState="4" CODIGO="52" DATA="20140527" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_PERDIDAS()                      &#013;BEGIN                                                                   &#013;INSERT INTO campanhas_clientes                                          &#013;(SELECT                                                                 &#013;&#009;NULL AS CODIGO,                                                      &#013;&#009;cc.CLIENTE,                                                          &#013;&#009;cc.CAMPANHA,                                                         &#013;&#009;&quot;0000-00-00&quot; AS DT_RESULTADO,                                        &#013;&#009;NOW() AS DT_AGENDAMENTO,                                             &#013;&#009;&quot;0&quot; AS RESULTADO,                                                    &#013;&#009;&quot;NAO&quot; AS CONCLUIDO,                                                  &#013;&#009;cc.FONE1,                                                            &#013;&#009;cc.FONE2,                                                            &#013;&#009;cc.FONE3,                                                            &#013;&#009;cc.ORDEM,                                                            &#013;&#009;cc.OPERADOR,                                                         &#013;&#009;cc.OPERADOR_LIGACAO,                                                 &#013;&#009;&quot;0000-00-00 00:00:00&quot; AS DATA_HORA_LIG,                              &#013;&#009;cc.TELEFONE_LIGADO,                                                  &#013;&#009;&quot;0000-00-00 00:00:00&quot; AS DATA_HORA_FIM,                              &#013;&#009;cc.AGENDA                                                            &#013;FROM                                                                    &#013;    campanhas_clientes cc                                               &#013;    LEFT JOIN resultados r ON (cc.RESULTADO = r.CODIGO)                 &#013;WHERE                                                                   &#013;   (cc.RESULTADO = &quot;0&quot; OR cc.RESULTADO IS NULL)                                                    &#013;   AND (r.COD_ACAO &lt;&gt; 6 or r.COD_ACAO is null)                          &#013;&#009;AND NOT EXISTS (                                                     &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009;SELECT                                             &#013;&#009;&#009;&#009;&#009;&#009;&#009; &#009;&#009;c1.CLIENTE                                      &#013;&#009;&#009;&#009;&#009;&#009;&#009; &#009;FROM                                               &#013;&#009;&#009;&#009;&#009;&#009;&#009; &#009;&#009;campanhas_clientes c1                           &#013;&#009;&#009;&#009;&#009;&#009;&#009; &#009;where                                              &#013;&#009;&#009;&#009;&#009;&#009;&#009; &#009;&#009;c1.CLIENTE = cc.CLIENTE                         &#013;&#009;&#009;&#009;&#009;&#009;&#009; &#009;&#009;AND c1.CONCLUIDO = &quot;NAO&quot;                        &#013;&#009;&#009;&#009;&#009;&#009;&#009; &#009;GROUP BY                                           &#013;&#009;&#009;&#009;&#009;&#009;&#009;&#009; &#009;c1.CLIENTE                                      &#013;&#009;&#009;&#009;&#009;&#009;&#009; )                                                    &#013;GROUP BY                                                                &#013;&#009;cc.CLIENTE                                                           &#013;ORDER BY                                                                &#013;&#009;cc.CODIGO DESC                                                       &#013;);   END;                                                                  "/><ROW RowState="4" CODIGO="53" DATA="20140527" SQL="DROP PROCEDURE IF EXISTS PR_ORGANIZA_ATUALIZACAO;"/><ROW RowState="5" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO() BEGIN  UPDATE clientes cli INNER JOIN unidades u ON(cli.COD_UNIDADE = u.CODIGO)SET cli.COD_CAMPANHA = IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_RECENTES, (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot; ATIVOS &quot;), IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS, (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot; INAT_R &quot;), IF (cli.DATA_ULT_COMPRA IS NULL, (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot; PROSPE &quot;), (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot; INAT_A &quot;)))); UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot; INAT_R &quot;, &quot; INAT_A &quot;, &quot; PROSPE &quot;) AND cli.OPERADOR &lt;&gt; 0;                                                UPDATE campanhas_clientes cc INNER JOIN clientes cli ON(cli.CODIGO = cc.CLIENTE)SET cc.CAMPANHA = cli.COD_CAMPANHA, cc.OPERADOR = cli.OPERADOR WHERE cc.CONCLUIDO = &quot; NÃO &quot;; END; "/><ROW RowState="4" CODIGO="55" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;SP&quot;,&quot;11&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="56" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;SP&quot;,&quot;12&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="57" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;SP&quot;,&quot;13&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="58" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;SP&quot;,&quot;14&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="59" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;SP&quot;,&quot;15&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="60" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;SP&quot;,&quot;16&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="61" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;SP&quot;,&quot;17&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="62" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;SP&quot;,&quot;18&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="63" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;SP&quot;,&quot;19&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="64" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;RJ&quot;,&quot;21&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="65" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;RJ&quot;,&quot;22&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="66" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;RJ&quot;,&quot;24&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="67" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;ES&quot;,&quot;27&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="68" DATA="20140527" SQL="INSERT INTO fone_digito (UF, DDD,&#009;DIGITO) VALUES (&quot;ES&quot;,&quot;28&quot;,&quot;9&quot;);"/><ROW RowState="4" CODIGO="69" DATA="20140527" SQL="ALTER TABLE campanhas_clientes DROP FOREIGN KEY FK_CAMP_CLI_CAMPANHA;"/><ROW RowState="4" CODIGO="70" DATA="20140527" SQL="ALTER TABLE campanhas_clientes DROP FOREIGN KEY fk_cc_cliente"/><ROW RowState="4" CODIGO="71" DATA="20140527" SQL="INSERT INTO resultados (CODIGO, NOME, TIPO, ESUCESSO, EVENDA, NOME_ACAO, ECONTATO, COD_ACAO, PRIORIDADE, PROPOSTA, FIDELIZARCOTACAO) VALUES (0, &quot;&quot;, &quot;AMBOS&quot;, &quot;NAO&quot;, &quot;NAO&quot;, &quot;&quot;, &quot;NAO&quot;, NULL, &quot;NAO&quot;, &quot;NAO&quot;, &quot;NAO&quot;)"/><ROW RowState="4" CODIGO="72" DATA="20140527" SQL="ALTER TABLE historico_cli ADD CONSTRAINT FK_HISTO_CLI_CLIENTE FOREIGN KEY (CLIENTE) REFERENCES clientes (CODIGO) ON DELETE RESTRICT ON UPDATE RESTRICT;"/><ROW RowState="4" CODIGO="73" DATA="20140527" SQL="ALTER TABLE campanhas_clientes ADD CONSTRAINT FK_CAMP_CLI_OPERADOR FOREIGN KEY (OPERADOR) REFERENCES operadores (CODIGO) ON DELETE RESTRICT ON UPDATE RESTRICT;"/><ROW RowState="4" CODIGO="74" DATA="20140527" SQL="ALTER TABLE campanhas_clientes ADD CONSTRAINT FK_CAMP_CLI_OPERADOR_LIGACAO FOREIGN KEY (OPERADOR_LIGACAO) REFERENCES operadores (CODIGO) ON DELETE RESTRICT ON UPDATE RESTRICT;"/><ROW RowState="4" CODIGO="75" DATA="20140527" SQL="ALTER TABLE campanhas_clientes ADD CONSTRAINT FK_CAMP_CLI_RESULTADO FOREIGN KEY (RESULTADO) REFERENCES resultados (CODIGO) ON DELETE RESTRICT ON UPDATE RESTRICT;"/><ROW RowState="4" CODIGO="76" DATA="20140527" SQL="ALTER TABLE campanhas_clientes ADD CONSTRAINT FK_CAMP_CLI_CLIENTE FOREIGN KEY (CLIENTE) REFERENCES clientes (CODIGO) ON DELETE RESTRICT ON UPDATE RESTRICT;"/><ROW RowState="4" CODIGO="77" DATA="20140527" SQL="ALTER TABLE resultados ADD CONSTRAINT `FK_RESULTADO_ACAO` FOREIGN KEY (`COD_ACAO`) REFERENCES `acoes` (`CODIGO`);"/><ROW RowState="4" CODIGO="78" DATA="20140527" SQL="ALTER TABLE historico_cli ADD CONSTRAINT `FK_HISTO_CLI_RESULTADO` FOREIGN KEY (`RESULTADO`) REFERENCES `resultados` (`CODIGO`);"/><ROW RowState="4" CODIGO="79" DATA="20140527" SQL="ALTER TABLE contatos ADD CONSTRAINT `FK_CONTATOS_CLIENTE` FOREIGN KEY (`CLIENTE`) REFERENCES `clientes` (`CODIGO`);"/><ROW RowState="4" CODIGO="80" DATA="20140527" SQL="ALTER TABLE clientes ADD CONSTRAINT `FK_CLIENTE_OPERADOR` FOREIGN KEY (`OPERADOR`) REFERENCES `operadores` (`CODIGO`);"/><ROW RowState="4" CODIGO="81" DATA="20140527" SQL="ALTER TABLE clientes ADD CONSTRAINT `FK_CLIENTE_RESULTADOS` FOREIGN KEY (`COD_RESULTADO`) REFERENCES `resultados` (`CODIGO`);"/><ROW RowState="4" CODIGO="82" DATA="20140527" SQL="ALTER TABLE login_ativo_receptivo ADD CONSTRAINT `FK_LOG_ATIV_REC_OPERADOR` FOREIGN KEY (`OPERADOR`) REFERENCES `operadores` (`CODIGO`);"/><ROW RowState="4" CODIGO="83" DATA="20140527" SQL="ALTER TABLE historico_cli ADD INDEX `IDX_HIST_CLI_OPERADOR` (`OPERADOR`);"/><ROW RowState="4" CODIGO="84" DATA="20140527" SQL="ALTER TABLE historico_cli ADD INDEX `IDX_HIST_CLI_CAMPANHA` (`CAMPANHA`);"/><ROW RowState="4" CODIGO="85" DATA="20140527" SQL="DELETE FROM alteracoes_clientes WHERE CODIGO_SGR NOT IN (SELECT CODIGO FROM clientes)"/><ROW RowState="4" CODIGO="86" DATA="20140527" SQL="ALTER TABLE alteracoes_clientes CHANGE CODIGO_SGR CODIGO_SGR integer(11);"/><ROW RowState="4" CODIGO="87" DATA="20140527" SQL="ALTER TABLE alteracoes_clientes CHANGE CAMPO CAMPO VARCHAR(40);"/><ROW RowState="4" CODIGO="88" DATA="20140527" SQL="ALTER TABLE alteracoes_clientes ADD CONSTRAINT FK_ALTERA_CLI_CLIENTE FOREIGN KEY (CODIGO_SGR) REFERENCES clientes (CODIGO) ON DELETE RESTRICT ON UPDATE RESTRICT;"/><ROW RowState="6" CODIGO="89" DATA="20140527" SQL="DROP VIEW vw_clientes;"/><ROW RowState="4" CODIGO="90" DATA="20140527" SQL="CREATE OR REPLACE VIEW vw_clientes &#013;  AS                                      &#013;     SELECT                               &#013;        CODIGO,                           &#013;        RAZAO,                            &#013;        FANTASIA,                         &#013;        COD_UNIDADE,                      &#013;        COD_ERP,                          &#013;        CPF_CNPJ,                         &#013;        AREA1,                            &#013;        FONE1&#009;&#009;                         &#013;     FROM                                 &#013;        clientes;                         "/><ROW RowState="4" CODIGO="91" DATA="20140527" SQL="ALTER TABLE clientes ADD INDEX IDX_CLIENTE_CNPJ(CPF_CNPJ);"/><ROW RowState="6" CODIGO="92" DATA="20140527"/><ROW RowState="4" CODIGO="93" DATA="20140527" SQL="DELETE FROM contatos&#013;&#010;WHERE &#013;&#010;&#009;NOT EXISTS &#013;&#010;&#009;&#009;&#009;(&#009;SELECT 1 &#013;&#010;&#009;&#009;&#009;&#009;FROM &#013;&#010;&#009;&#009;&#009;&#009;&#009;clientes CL &#013;&#010;&#009;&#009;&#009;&#009;WHERE &#013;&#010;&#009;&#009;&#009;&#009;&#009;CL.CODIGO = CLIENTE&#013;&#010;&#009;&#009;&#009;);"/><ROW RowState="4" CODIGO="94" DATA="20140527" SQL="ALTER TABLE contatos ADD &#013;&#010;CONSTRAINT FK_CONTATOS_CLIENTE &#013;&#010;FOREIGN KEY (CLIENTE) &#013;&#010;REFERENCES clientes (CODIGO);"/><ROW RowState="4" CODIGO="95" DATA="20140527" SQL="ALTER TABLE resultados ADD&#013;&#010;(&#013;&#010;&#009;PESQUISA_SATISFACAO ENUM(&quot;S&quot;,&quot;N&quot;) NOT NULL DEFAULT &quot;N&quot;&#013;&#010;);"/><ROW RowState="4" CODIGO="96" DATA="20140527" SQL="CREATE TABLE pesquisa_satisfacao&#013;&#010;(&#013;&#010;&#009;PESQSAT_CODIGO INT(11) &#009;&#009;  NOT NULL AUTO_INCREMENT,&#013;&#010;&#009;PESQ_DESCRICAO VARCHAR(1000) NOT NULL,&#013;&#010;&#009;PRIMARY KEY (PESQSAT_CODIGO)&#013;&#010;);"/><ROW RowState="4" CODIGO="97" DATA="20140527" SQL="CREATE TABLE pesquisa_satisfacao_avaliacao&#013;&#010;(&#013;&#010;&#009;CAMPCLI_CODIGO    INT(11) NOT NULL,&#013;&#010;   PESQSAT_CODIGO    INT(11) NOT NULL,&#013;&#010;&#009;PESQSAT_AVALIACAO ENUM(&quot;&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;),&#013;&#010;&#009;PRIMARY KEY (CAMPCLI_CODIGO, PESQSAT_CODIGO)&#013;&#010;);"/><ROW RowState="4" CODIGO="98" DATA="20140527" SQL="ALTER TABLE pesquisa_satisfacao_avaliacao ADD &#013;&#010;CONSTRAINT FK_PESQ_SATIS_AVAL_PESQ_CODIGO&#013;&#010;FOREIGN KEY (PESQSAT_CODIGO) &#013;&#010;REFERENCES pesquisa_satisfacao (PESQSAT_CODIGO);"/><ROW RowState="4" CODIGO="99" DATA="20140527" SQL="ALTER TABLE pesquisa_satisfacao_avaliacao ADD &#013;&#010;CONSTRAINT FK_PESQ_SATIS_AVAL_CAMPCLI_COD&#013;&#010;FOREIGN KEY (CAMPCLI_CODIGO) &#013;&#010;REFERENCES campanhas_clientes (CODIGO);"/><ROW RowState="13" CODIGO="48" DATA="20140527" SQL="DELIMITER $$&#013;&#010;CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;&#009;&#009;(SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;cc.OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;&#013;&#010;$$&#013;&#010;&#009;&#009;  OPEN C_FIDELIZA;                                                     &#013;&#010;                                                                            &#013;&#010;&#009;&#009;&#009;C_FIDELIZA_LOOP:LOOP                                                &#013;&#010;&#009;&#009;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;                      &#013;&#010;&#009;&#009;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;UPDATE                                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;campanhas_clientes                                         &#013;&#010;&#009;&#009;&#009;&#009;&#009;SET                                                           &#013;&#010;&#009;&#009;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR                                       &#013;&#010;&#009;&#009;&#009;&#009;&#009;WHERE                                                         &#013;&#010;&#009;&#009;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE                                         &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot;                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;ORDER BY                                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;CODIGO DESC                                                &#013;&#010;&#009;&#009;&#009;&#009;&#009;LIMIT 1;                                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;                                        &#013;&#010;&#009;&#009;&#009;&#009;END IF;                                                          &#013;&#010;&#009;&#009;&#009;&#009;IF SAI = 1 THEN                                                  &#013;&#010;&#009;&#009;         &#009;LEAVE C_FIDELIZA_LOOP;                                     &#013;&#010;&#009;&#009;      END IF;                                                          &#013;&#010;&#009;&#009;&#009;END LOOP C_FIDELIZA_LOOP;                                           &#013;&#010;&#009;&#009;   CLOSE C_FIDELIZA;                                                   &#013;&#010;                                                                            &#013;&#010;   END;                                                                     &#013;&#010;   IF SAI2 = 1 THEN                                                         &#013;&#010;&#009;   LEAVE C_CLIENTE_LOOP;                                                  &#013;&#010;&#009;END IF;                                                                   &#013;&#010;&#009;END LOOP C_CLIENTE_LOOP;                                                  &#013;&#010;&#009;CLOSE C_CLIENTE;                                                          &#013;&#010;END;                                                                          "/><ROW RowState="13" CODIGO="48" DATA="20140527" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;&#009;&#009;(SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;cc.OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;&#013;&#010;$$&#013;&#010;&#009;&#009;  OPEN C_FIDELIZA;                                                     &#013;&#010;                                                                            &#013;&#010;&#009;&#009;&#009;C_FIDELIZA_LOOP:LOOP                                                &#013;&#010;&#009;&#009;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;                      &#013;&#010;&#009;&#009;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;UPDATE                                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;campanhas_clientes                                         &#013;&#010;&#009;&#009;&#009;&#009;&#009;SET                                                           &#013;&#010;&#009;&#009;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR                                       &#013;&#010;&#009;&#009;&#009;&#009;&#009;WHERE                                                         &#013;&#010;&#009;&#009;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE                                         &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot;                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;ORDER BY                                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;CODIGO DESC                                                &#013;&#010;&#009;&#009;&#009;&#009;&#009;LIMIT 1;                                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;                                        &#013;&#010;&#009;&#009;&#009;&#009;END IF;                                                          &#013;&#010;&#009;&#009;&#009;&#009;IF SAI = 1 THEN                                                  &#013;&#010;&#009;&#009;         &#009;LEAVE C_FIDELIZA_LOOP;                                     &#013;&#010;&#009;&#009;      END IF;                                                          &#013;&#010;&#009;&#009;&#009;END LOOP C_FIDELIZA_LOOP;                                           &#013;&#010;&#009;&#009;   CLOSE C_FIDELIZA;                                                   &#013;&#010;                                                                            &#013;&#010;   END;                                                                     &#013;&#010;   IF SAI2 = 1 THEN                                                         &#013;&#010;&#009;   LEAVE C_CLIENTE_LOOP;                                                  &#013;&#010;&#009;END IF;                                                                   &#013;&#010;&#009;END LOOP C_CLIENTE_LOOP;                                                  &#013;&#010;&#009;CLOSE C_CLIENTE;                                                          &#013;&#010;END;                                                                          "/><ROW RowState="13" CODIGO="48" DATA="20140527" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;&#009;&#009;(SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;cc.OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;&#013;&#010;                                                                   "/><ROW RowState="13" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO() &#013;&#010;BEGIN  &#013;&#010;UPDATE clientes cli &#013;&#010;INNER JOIN unidades u ON(cli.COD_UNIDADE = u.CODIGO)&#013;&#010;SET cli.COD_CAMPANHA = IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_RECENTES, &#013;&#010;(SELECT CODIGO FROM campanhas &#013;&#010;WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;ATIVOS&quot;), &#013;&#010;IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS, &#013;&#010;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_R&quot;),&#013;&#010; IF (cli.DATA_ULT_COMPRA IS NULL, (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;PROSPE&quot;), &#013;&#010; (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_A&quot;))));&#013;&#010; &#013;&#010;UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)&#013;&#010;SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND cli.OPERADOR &lt;&gt; 0; &#013;&#010;&#013;&#010;UPDATE campanhas_clientes cc INNER JOIN clientes cli &#013;&#010;ON(cli.CODIGO = cc.CLIENTE)SET cc.CAMPANHA = cli.COD_CAMPANHA, cc.OPERADOR = cli.OPERADOR &#013;&#010;WHERE cc.CONCLUIDO = &quot;NÃO&quot;; &#013;&#010;END; "/><ROW RowState="12" CODIGO="5" DATA="20140527" SQL="CREATE TABLE IF NOT EXISTS `ddds_diferentes` ( &#013;&#010;`CODIGO` INT(11) NOT NULL AUTO_INCREMENT, &#013;&#010;`CIDADE` VARCHAR(255) NULL DEFAULT NULL,&#013;&#010;`DDD` VARCHAR(255) NULL DEFAULT NULL, &#013;&#010;`USAR` ENUM(&quot;SIM&quot;,&quot;NÃO&quot;) NULL DEFAULT NULL, &#013;&#010;PRIMARY KEY (`CODIGO`), &#013;&#010;UNIQUE INDEX `CIDADE` (`CIDADE`, `DDD`) &#013;&#010;) "/><ROW RowState="12" CODIGO="22" DATA="20140527" SQL="ALTER TABLE operadores ADD COLUMN ASTERISK_RAMAL VARCHAR(150) NULL DEFAULT NULL  "/><ROW RowState="13" CODIGO="48" DATA="20140527" SQL="DELIMITER $$&#013;&#010;DROP PROCEDURE IF EXISTS PR_REPOE_LIGACOES_FIDELIZADAS;&#013;&#010;$$&#013;&#010;&#013;&#010;DELIMITER $$&#013;&#010;CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, CC.OPERADOR_LIGACAO, 0) OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;&#009;operadores o           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;&#013;&#010;$$                                     "/><ROW RowState="13" CODIGO="48" DATA="20140527" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, CC.OPERADOR_LIGACAO, 0) OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;&#009;operadores o           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;&#013;&#010;"/><ROW RowState="5" CODIGO="100" DATA="20141215" SQL="ALTER TABLE pausas_realizadas ADD DATA_HORA_FIM DATETIME;"/><ROW RowState="13" CODIGO="100" DATA="20141215" SQL="ALTER TABLE pausas_realizadas ADD DATA_HORA_FIM DATETIME"/><ROW RowState="12" CODIGO="100" DATA="20141215" SQL="ALTER TABLE pausas_realizadas ADD DATA_HORA_FIM DATETIME;"/><ROW RowState="13" CODIGO="48" DATA="20140527" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, CC.OPERADOR, 0) OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;&#009;operadores o           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;AND cc.OPERADOR = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;&#013;&#010;"/><ROW RowState="13" CODIGO="48" DATA="20140527" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, OPERADOR_LIGACAO, 0) OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;&#009;operadores o           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;&#013;&#010;"/><ROW RowState="4" CODIGO="101" DATA="20150824" SQL="ALTER TABLE itens_compra MODIFY DESCRICAO VARCHAR(100);"/><ROW RowState="5" CODIGO="102" DATA="20150825" SQL="ALTER TABLE fone_digito drop FK_FONE_DIGITO_UF;"/><ROW RowState="12" CODIGO="102" DATA="20150825" SQL="ALTER TABLE fone_digito DROP FOREIGN KEY FK_FONE_DIGITO_UF;"/><ROW RowState="5" CODIGO="103" DATA="20150827" SQL="DROP INDEX NOME ON CIDADE;"/><ROW RowState="13" CODIGO="103" DATA="20150827" SQL="DROP INDEX NOME ON cidade;"/><ROW RowState="12" CODIGO="103" DATA="20150827" SQL="DROP INDEX NOME ON cidades;"/><ROW RowState="5" CODIGO="104" DATA="20150916" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, OPERADOR_LIGACAO, 0) OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;&#009;operadores o           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;"/><ROW RowState="13" CODIGO="104" DATA="20150916" SQL="drop PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS;&#013;&#010;&#013;&#010;CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, OPERADOR_LIGACAO, 0) OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;&#009;operadores o           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;"/><ROW RowState="14" CODIGO="104" DATA="20150916" SQL="drop PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS;&#013;&#010;&#013;&#010;"/><ROW RowState="5" CODIGO="105" DATA="20150916" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, OPERADOR_LIGACAO, 0) OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;&#009;operadores o           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;"/><ROW RowState="14" CODIGO="105" DATA="20150916" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, OPERADOR_LIGACAO, 0) OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;&#009;operadores o           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;&#013;&#010;"/><ROW RowState="4" CODIGO="106" DATA="20151007" SQL="ALTER TABLE clientes CHANGE RAZAO RAZAO VARCHAR(100) NOT NULL;"/><ROW RowState="4" CODIGO="107" DATA="20151012" SQL="ALTER TABLE cidades ADD INDEX IDX_CIDADE_NOME_UF(NOME, UF);"/><ROW RowState="4" CODIGO="108" DATA="20151012" SQL="ALTER TABLE unidades ADD INDEX IDX_UNIDADE_DESCRICAO(DESCRICAO);"/><ROW RowState="4" CODIGO="109" DATA="20151012" SQL="ALTER TABLE operadores ADD INDEX IDX_OPERADOR_CODIGO_ERP(CODIGO_ERP);"/><ROW RowState="4" CODIGO="110" DATA="20151012" SQL="ALTER TABLE segmentos ADD INDEX IDX_SEGMENTO_NOME(NOME);"/><ROW RowState="4" CODIGO="111" DATA="20151111" SQL="ALTER TABLE campanhasxoperadores ADD &#013;&#010;CONSTRAINT FK_CAMPANHAXOPERADOR_CAMPANHA&#013;&#010;FOREIGN KEY (CAMPANHA) &#013;&#010;REFERENCES campanhas (CODIGO);&#013;&#010;&#013;&#010;"/><ROW RowState="4" CODIGO="112" DATA="20151111" SQL="ALTER TABLE campanhasxoperadores ADD &#013;&#010;CONSTRAINT FK_CAMPANHAXOPERADOR_OPERADOR&#013;&#010;FOREIGN KEY (OPERADOR) &#013;&#010;REFERENCES operadores (CODIGO);"/><ROW RowState="5" CODIGO="113" DATA="20151215" SQL="ALTER TABLE uf &#013;&#010;ADD FUSOHORARIO INTEGER DEFAULT 0 NOT NULL;"/><ROW RowState="12" CODIGO="113" DATA="20151215" SQL="ALTER TABLE uf ADD FUSOHORARIO INTEGER DEFAULT 0 NOT NULL;"/><ROW RowState="4" CODIGO="114" DATA="20151220" SQL="ALTER TABLE operadores ADD &#013;&#010;CONSTRAINT FK_OPERADOR_HORARIO&#013;&#010;FOREIGN KEY (HORARIO) &#013;&#010;REFERENCES horarios (CODIGO);"/><ROW RowState="4" CODIGO="115" DATA="20151222" SQL="ALTER TABLE parametros ADD FUSO_HORARIO CHAR(1) DEFAULT &apos;N&apos; NOT NULL;"/><ROW RowState="13" CODIGO="44" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_CAMPANHAS() &#013;&#010;BEGIN&#013;&#010;&#009;UPDATE&#013;&#010;&#009;&#009;campanhas_clientes cc                                                                                                                 &#013;&#010;&#009;INNER JOIN                                                                                                                               &#013;&#010;&#009;&#009;clientes cli ON (cc.CLIENTE = cli.CODIGO)                                                                                             &#013;&#010;&#009;SET&#013;&#010;&#009;&#009;&#009;cc.CAMPANHA = @cc := &#013;&#010;&#009;&#009;&#009;&#009;if&#013;&#010;&#009;&#009;&#009;&#009;&#009;(                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA                                                                                                       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;BETWEEN DATE_SUB(now(), INTERVAL(SELECT INATIVOS_RECENTES FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY)       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;AND NOW(),                                                                                                             &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO) FROM campanhas c WHERE c.UNIDADE = cli.COD_UNIDADE),                                            &#013;&#010;&#009;&#009;&#009;&#009;&#009;IF                                                                                                                           &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;( &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA                                                                                                    &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;BETWEEN DATE_SUB(NOW(),INTERVAL (SELECT INATIVOS_ANTIGOS FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY)     &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;AND DATE_SUB(now(),INTERVAL (SELECT INATIVOS_RECENTES FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY),       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)+1 FROM campanhas c where c.UNIDADE = cli.COD_UNIDADE),                                       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;IF                                                                                                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(                                                                                                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA IS NULL,                                                                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO) FROM campanhas c WHERE c.UNIDADE=cli.COD_UNIDADE),                                           &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)-1 FROM campanhas c WHERE c.UNIDADE = cli.COD_UNIDADE)                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;)                                                                                                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;)                                                                                                                         &#013;&#010;&#009;&#009;&#009;&#009;&#009;),                                                                                                                           &#013;&#010;&#009;&#009;cli.COD_CAMPANHA = @cc                                                                                                                &#013;&#010;&#009;WHERE                                                                                                                                    &#013;&#010;&#009;&#009;cli.COD_UNIDADE &gt; 0                                                                                                                   &#013;&#010;&#009;&#009;AND cc.CONCLUIDO = &quot;NAO&quot;                                                                                                             &#013;&#010;      AND NOT cc.AGENDA IN (-250, -200, -100);                                       &#013;&#010;END;"/><ROW RowState="13" CODIGO="44" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_CAMPANHAS() &#013;&#010;BEGIN&#013;&#010;&#009;UPDATE&#013;&#010;&#009;&#009;campanhas_clientes cc                                                                                                                 &#013;&#010;&#009;INNER JOIN                                                                                                                               &#013;&#010;&#009;&#009;clientes cli ON (cc.CLIENTE = cli.CODIGO)                                                                                             &#013;&#010;&#009;SET&#013;&#010;&#009;&#009;&#009;cc.CAMPANHA = @cc := &#013;&#010;&#009;&#009;&#009;&#009;if&#013;&#010;&#009;&#009;&#009;&#009;&#009;(                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA                                                                                                       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;BETWEEN DATE_SUB(now(), INTERVAL(SELECT INATIVOS_RECENTES FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY)       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;AND NOW(),                                                                                                             &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO) FROM campanhas c WHERE c.UNIDADE = cli.COD_UNIDADE),                                            &#013;&#010;&#009;&#009;&#009;&#009;&#009;IF                                                                                                                           &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;( &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA                                                                                                    &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;BETWEEN DATE_SUB(NOW(),INTERVAL (SELECT INATIVOS_ANTIGOS FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY)     &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;AND DATE_SUB(now(),INTERVAL (SELECT INATIVOS_RECENTES FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY),       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)+1 FROM campanhas c where c.UNIDADE = cli.COD_UNIDADE),                                       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;IF                                                                                                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(                                                                                                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA IS NULL,                                                                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO) FROM campanhas c WHERE c.UNIDADE=cli.COD_UNIDADE),                                           &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)-1 FROM campanhas c WHERE c.UNIDADE = cli.COD_UNIDADE)                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;)                                                                                                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;)                                                                                                                         &#013;&#010;&#009;&#009;&#009;&#009;&#009;),                                                                                                                           &#013;&#010;&#009;&#009;cli.COD_CAMPANHA = @cc                                                                                                                &#013;&#010;&#009;WHERE                                                                                                                                    &#013;&#010;&#009;&#009;cli.COD_UNIDADE &gt; 0                                                                                                                   &#013;&#010;&#009;&#009;AND cc.CONCLUIDO = &quot;NAO&quot;;&#013;&#010;END;"/><ROW RowState="13" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO() &#013;&#010;BEGIN  &#013;&#010;UPDATE clientes cli &#013;&#010;INNER JOIN unidades u ON(cli.COD_UNIDADE = u.CODIGO)&#013;&#010;SET cli.COD_CAMPANHA = IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_RECENTES, &#013;&#010;(SELECT CODIGO FROM campanhas &#013;&#010;WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;ATIVOS&quot;), &#013;&#010;IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS, &#013;&#010;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_R&quot;),&#013;&#010; IF (cli.DATA_ULT_COMPRA IS NULL, (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;PROSPE&quot;), &#013;&#010; (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_A&quot;))));&#013;&#010; &#013;&#010;UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)&#013;&#010;SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND cli.OPERADOR &lt;&gt; 0; &#013;&#010;&#013;&#010;UPDATE campanhas_clientes cc INNER JOIN clientes cli &#013;&#010;ON(cli.CODIGO = cc.CLIENTE)SET cc.CAMPANHA = cli.COD_CAMPANHA, cc.OPERADOR = cli.OPERADOR &#013;&#010;WHERE cc.CONCLUIDO = &quot;NÃO&quot;&#013;&#010;AND NOT cc.AGENDA IN (-250, -200, -100); &#013;&#010;END; "/><ROW RowState="13" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO() &#013;&#010;BEGIN  &#013;&#010;UPDATE clientes cli &#013;&#010;INNER JOIN unidades u ON(cli.COD_UNIDADE = u.CODIGO)&#013;&#010;SET cli.COD_CAMPANHA = IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_RECENTES, &#013;&#010;(SELECT CODIGO FROM campanhas &#013;&#010;WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;ATIVOS&quot;), &#013;&#010;IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS, &#013;&#010;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_R&quot;),&#013;&#010; IF (cli.DATA_ULT_COMPRA IS NULL, (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;PROSPE&quot;), &#013;&#010; (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_A&quot;))));&#013;&#010; &#013;&#010;UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)&#013;&#010;SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND cli.OPERADOR &lt;&gt; 0; &#013;&#010;&#013;&#010;UPDATE campanhas_clientes cc INNER JOIN clientes cli &#013;&#010;ON(cli.CODIGO = cc.CLIENTE)SET cc.CAMPANHA = cli.COD_CAMPANHA, cc.OPERADOR = cli.OPERADOR &#013;&#010;WHERE cc.CONCLUIDO = &quot;NAO&quot;&#013;&#010;AND NOT cc.AGENDA IN (-250, -200, -100); &#013;&#010;&#013;&#010;UPDATE campanhas_clientes cc &#013;&#010;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;INNER JOIN resultados r ON (r.CODIGO = cc.RESULTADO) &#009;&#013;&#010;SET &#013;&#010;   cc.CAMPANHA = cli.COD_CAMPANHA, &#013;&#010;   cc.OPERADOR = cli.OPERADOR &#013;&#010;WHERE &#013;&#010;   cc.CONCLUIDO = &quot;NAO&quot;&#013;&#010;   AND NOT cc.AGENDA IN (-250, -200, -100, -2)&#013;&#010;   AND r.COD_ACAO &lt;&gt; 8 ; &#013;&#010;&#013;&#010;END; "/><ROW RowState="13" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO() &#013;&#010;BEGIN  &#013;&#010;UPDATE clientes cli &#013;&#010;INNER JOIN unidades u ON(cli.COD_UNIDADE = u.CODIGO)&#013;&#010;SET cli.COD_CAMPANHA = IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_RECENTES, &#013;&#010;(SELECT CODIGO FROM campanhas &#013;&#010;WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;ATIVOS&quot;), &#013;&#010;IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS, &#013;&#010;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_R&quot;),&#013;&#010; IF (cli.DATA_ULT_COMPRA IS NULL, (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;PROSPE&quot;), &#013;&#010; (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_A&quot;))));&#013;&#010; &#013;&#010;UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)&#013;&#010;SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND cli.OPERADOR &lt;&gt; 0; &#013;&#010;&#013;&#010;UPDATE campanhas_clientes cc &#013;&#010;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;INNER JOIN resultados r ON (r.CODIGO = cc.RESULTADO) &#009;&#013;&#010;SET &#013;&#010;   cc.CAMPANHA = cli.COD_CAMPANHA, &#013;&#010;   cc.OPERADOR = cli.OPERADOR &#013;&#010;WHERE &#013;&#010;   cc.CONCLUIDO = &quot;NAO&quot;&#013;&#010;   AND NOT cc.AGENDA IN (-250, -200, -100, -2)&#013;&#010;   AND r.COD_ACAO &lt;&gt; 8 ; &#013;&#010;&#013;&#010;END; "/><ROW RowState="12" CODIGO="44" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_CAMPANHAS() &#013;&#010;BEGIN&#013;&#010;&#009;UPDATE&#013;&#010;&#009;&#009;campanhas_clientes cc                                                                                                                 &#013;&#010;&#009;INNER JOIN                                                                                                                               &#013;&#010;&#009;&#009;clientes cli ON (cc.CLIENTE = cli.CODIGO)                                                                                             &#013;&#010;&#009;SET&#013;&#010;&#009;&#009;&#009;cc.CAMPANHA = @cc := &#013;&#010;&#009;&#009;&#009;&#009;if&#013;&#010;&#009;&#009;&#009;&#009;&#009;(                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA                                                                                                       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;BETWEEN DATE_SUB(now(), INTERVAL(SELECT INATIVOS_RECENTES FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY)       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;AND NOW(),                                                                                                             &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO) FROM campanhas c WHERE c.UNIDADE = cli.COD_UNIDADE),                                            &#013;&#010;&#009;&#009;&#009;&#009;&#009;IF                                                                                                                           &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;( &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA                                                                                                    &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;BETWEEN DATE_SUB(NOW(),INTERVAL (SELECT INATIVOS_ANTIGOS FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY)     &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;AND DATE_SUB(now(),INTERVAL (SELECT INATIVOS_RECENTES FROM unidades u WHERE u.CODIGO = cli.COD_UNIDADE) DAY),       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)+1 FROM campanhas c where c.UNIDADE = cli.COD_UNIDADE),                                       &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;IF                                                                                                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(                                                                                                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;cli.DATA_ULT_COMPRA IS NULL,                                                                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO) FROM campanhas c WHERE c.UNIDADE=cli.COD_UNIDADE),                                           &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)-1 FROM campanhas c WHERE c.UNIDADE = cli.COD_UNIDADE)                                        &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;)                                                                                                                      &#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;)                                                                                                                         &#013;&#010;&#009;&#009;&#009;&#009;&#009;),                                                                                                                           &#013;&#010;&#009;&#009;cli.COD_CAMPANHA = @cc                                                                                                                &#013;&#010;&#009;WHERE                                                                                                                                    &#013;&#010;&#009;&#009;cli.COD_UNIDADE &gt; 0                                                                                                                   &#013;&#010;&#009;&#009;AND cc.CONCLUIDO = &quot;NAO&quot;&#013;&#010;                                AND NOT cc.AGENDA IN (-250, -200, -100, -2);&#013;&#010;END;"/><ROW RowState="5" CODIGO="116" DATA="20160214" SQL="ALTER TABLE parametros ADD INCLUI_CLIENTE_CAMP_PRINC_IMP VARCHAR(1) DEFAULT &apos;N&apos; NOT NULL"/><ROW RowState="12" CODIGO="116" DATA="20160214" SQL="ALTER TABLE parametros ADD INCLUI_CLIENTE_CAMP_PRINC_IMP VARCHAR(1) DEFAULT &apos;N&apos; NOT NULL;"/><ROW RowState="6" CODIGO="117" DATA="20160228" SQL="ALTER TABLE operadores ADD CODEC VARCHAR(2);"/><ROW RowState="4" CODIGO="118" DATA="20160303" SQL="ALTER TABLE operadores ADD CODEC VARCHAR(30);"/><ROW RowState="5" CODIGO="119" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;PE&apos;,&apos;81&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="120" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;PE&apos;,&apos;87&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="121" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;AL&apos;,&apos;82&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="122" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;PB&apos;,&apos;83&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="123" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;RN&apos;,&apos;84&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="124" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;CE&apos;,&apos;85&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="125" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;CE&apos;,&apos;88&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="126" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;PI&apos;,&apos;86&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="127" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;PI&apos;,&apos;89&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="128" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;PA&apos;,&apos;91&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="129" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;AM&apos;,&apos;92&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="130" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;PA&apos;,&apos;93&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="131" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;PA&apos;,&apos;94&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="132" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;RR&apos;,&apos;95&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="133" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;AP&apos;,&apos;96&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="134" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;MA&apos;,&apos;98&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="135" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;MA&apos;,&apos;99&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="136" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;BA&apos;,&apos;71&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="137" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;BA&apos;,&apos;73&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="138" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;BA&apos;,&apos;74&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="139" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;BA&apos;,&apos;75&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="140" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;BA&apos;,&apos;77&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="141" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;SE&apos;,&apos;79&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="142" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;MG&apos;,&apos;31&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="143" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;MG&apos;,&apos;32&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="144" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;MG&apos;,&apos;33&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="145" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;MG&apos;,&apos;34&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="146" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;MG&apos;,&apos;35&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="147" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;MG&apos;,&apos;36&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="148" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;MG&apos;,&apos;37&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="149" DATA="20160308" SQL="INSERT INTO FONE_DIGITO VALUES (&apos;MG&apos;,&apos;38&apos;,&apos;9&apos;);"/><ROW RowState="12" CODIGO="119" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;PE&apos;,&apos;81&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="120" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;PE&apos;,&apos;87&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="121" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;AL&apos;,&apos;82&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="122" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;PB&apos;,&apos;83&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="123" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;RN&apos;,&apos;84&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="124" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;CE&apos;,&apos;85&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="125" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;CE&apos;,&apos;88&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="126" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;PI&apos;,&apos;86&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="127" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;PI&apos;,&apos;89&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="128" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;PA&apos;,&apos;91&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="129" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;AM&apos;,&apos;92&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="130" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;PA&apos;,&apos;93&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="131" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;PA&apos;,&apos;94&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="132" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;RR&apos;,&apos;95&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="133" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;AP&apos;,&apos;96&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="134" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;MA&apos;,&apos;98&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="135" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;MA&apos;,&apos;99&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="136" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;BA&apos;,&apos;71&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="137" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;BA&apos;,&apos;73&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="138" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;BA&apos;,&apos;74&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="139" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;BA&apos;,&apos;75&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="140" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;BA&apos;,&apos;77&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="141" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;SE&apos;,&apos;79&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="142" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;MG&apos;,&apos;31&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="143" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;MG&apos;,&apos;32&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="144" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;MG&apos;,&apos;33&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="145" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;MG&apos;,&apos;34&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="146" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;MG&apos;,&apos;35&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="147" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;MG&apos;,&apos;36&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="148" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;MG&apos;,&apos;37&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="12" CODIGO="149" DATA="20160308" SQL="INSERT INTO fone_digito VALUES (&apos;MG&apos;,&apos;38&apos;,&apos;9&apos;);"/><ROW RowState="4" CODIGO="150" DATA="20160413" SQL="DROP PROCEDURE IF EXISTS PR_ATUALIZA_DT_ULT_COMPRA_CLI;"/><ROW RowState="5" CODIGO="151" DATA="20160413" SQL="CREATE PROCEDURE PR_ATUALIZA_DT_ULT_COMPRA_CLI()&#013;&#010;BEGIN&#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;INNER JOIN&#013;&#010;&#009;campanhas_clientes CC ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;INNER JOIN&#013;&#010;&#009;resultados R ON (R.CODIGO = CC.RESULTADO)&#013;&#010;SET&#013;&#010;&#009;CC.OPERADOR = 0,&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &lt;&gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2)&#013;&#010;&#009;AND R.COD_ACAO &lt;&gt; 8&#013;&#010;&#009;AND (CLI.DATA_ULT_COMPRA &lt; DATE_SUB(NOW(), INTERVAL (SELECT INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY)&#013;&#010;&#009;&#009;  OR CLI.DATA_ULT_COMPRA IS NULL);&#013;&#010;           &#013;&#010;UPDATE clientes SET OPERADOR = 0 WHERE DATA_ULT_COMPRA IS NULL;&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;campanhas_clientes CC&#013;&#010;&#009;INNER JOIN clientes CLI ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;SET&#013;&#010;&#009;CC.CAMPANHA = @CC := IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND NOW(),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_ANTIGOS&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND DATE_SUB(NOW(), INTERVAL (&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)+1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)-1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE)))),&#013;&#010; &#009;CLI.COD_CAMPANHA = @CC&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2);&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;SET&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.DATA_ULT_COMPRA &lt;= DATE_SUB(NOW(), INTERVAL (SELECT U.INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY);&#013;&#010;END;"/><ROW RowState="13" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO() &#013;&#010;BEGIN  &#013;&#010;UPDATE clientes cli &#013;&#010;INNER JOIN unidades u ON(cli.COD_UNIDADE = u.CODIGO)&#013;&#010;SET cli.COD_CAMPANHA = IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_RECENTES, &#013;&#010;(SELECT CODIGO FROM campanhas &#013;&#010;WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;ATIVOS&quot;), &#013;&#010;IF (DATEDIFF(now(), cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS, &#013;&#010;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_R&quot;),&#013;&#010; IF (cli.DATA_ULT_COMPRA IS NULL, (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;PROSPE&quot;), &#013;&#010; (SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_A&quot;))));&#013;&#010; &#013;&#010;UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)&#013;&#010;SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND cli.OPERADOR &lt;&gt; 0; &#013;&#010;&#013;&#010;UPDATE campanhas_clientes cc &#013;&#010;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;INNER JOIN resultados r ON (r.CODIGO = cc.RESULTADO) &#009;&#013;&#010;SET &#013;&#010;   cc.CAMPANHA = cli.COD_CAMPANHA, &#013;&#010;   cc.OPERADOR = cli.OPERADOR &#013;&#010;WHERE &#013;&#010;   cc.CONCLUIDO = &quot;NAO&quot;&#013;&#010;   AND NOT cc.AGENDA IN (-250, -200, -100, -2)&#013;&#010;   AND r.COD_ACAO &lt;&gt; 8 ; &#013;&#010;&#013;&#010;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;SET &#013;&#010;   &#009;&#009;cc.CAMPANHA = cli.COD_CAMPANHA&#013;&#010;&#009;WHERE &#013;&#010;   &#009;&#009;cc.CONCLUIDO = &quot;NAO&quot;;&#013;&#010;&#013;&#010;END; "/><ROW RowState="13" CODIGO="151" DATA="20160413" SQL="CREATE PROCEDURE PR_ATUALIZA_DT_ULT_COMPRA_CLI()&#013;&#010;BEGIN&#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;INNER JOIN&#013;&#010;&#009;campanhas_clientes CC ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;INNER JOIN&#013;&#010;&#009;resultados R ON (R.CODIGO = CC.RESULTADO)&#013;&#010;SET&#013;&#010;&#009;CC.OPERADOR = 0,&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &lt;&gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2)&#013;&#010;&#009;AND R.COD_ACAO &lt;&gt; 8&#013;&#010;&#009;AND (CLI.DATA_ULT_COMPRA &lt; DATE_SUB(NOW(), INTERVAL (SELECT INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY)&#013;&#010;&#009;&#009;  OR CLI.DATA_ULT_COMPRA IS NULL);&#013;&#010;           &#013;&#010;UPDATE clientes SET OPERADOR = 0 WHERE DATA_ULT_COMPRA IS NULL;&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;campanhas_clientes CC&#013;&#010;&#009;INNER JOIN clientes CLI ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;SET&#013;&#010;&#009;CC.CAMPANHA = @CC := IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND NOW(),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_ANTIGOS&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND DATE_SUB(NOW(), INTERVAL (&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)+1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)-1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE)))),&#013;&#010; &#009;CLI.COD_CAMPANHA = @CC&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2);&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;SET&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.DATA_ULT_COMPRA &lt;= DATE_SUB(NOW(), INTERVAL (SELECT U.INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY);&#013;&#010;END;"/><ROW RowState="12" CODIGO="151" DATA="20160413" SQL="CREATE PROCEDURE PR_ATUALIZA_DT_ULT_COMPRA_CLI()&#013;&#010;BEGIN&#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;INNER JOIN&#013;&#010;&#009;campanhas_clientes CC ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;INNER JOIN&#013;&#010;&#009;resultados R ON (R.CODIGO = CC.RESULTADO)&#013;&#010;SET&#013;&#010;&#009;CC.OPERADOR = 0,&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &lt;&gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2)&#013;&#010;&#009;AND R.COD_ACAO &lt;&gt; 8&#013;&#010;&#009;AND (CLI.DATA_ULT_COMPRA &lt; DATE_SUB(NOW(), INTERVAL (SELECT INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY)&#013;&#010;&#009;&#009;  OR CLI.DATA_ULT_COMPRA IS NULL);&#013;&#010;           &#013;&#010;UPDATE clientes SET OPERADOR = 0 WHERE DATA_ULT_COMPRA IS NULL;&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;campanhas_clientes CC&#013;&#010;&#009;INNER JOIN clientes CLI ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;SET&#013;&#010;&#009;CC.CAMPANHA = @CC := IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND NOW(),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_ANTIGOS&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND DATE_SUB(NOW(), INTERVAL (&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)+1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)-1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE)))),&#013;&#010; &#009;CLI.COD_CAMPANHA = @CC&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2);&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;SET&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.DATA_ULT_COMPRA &lt;= DATE_SUB(NOW(), INTERVAL (SELECT U.INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY)&#013;&#010;AND CLI.OPERADOR &lt;&gt; -2;&#013;&#010;END;"/><ROW RowState="13" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO()&#013;&#010;BEGIN&#013;&#010;&#009;&#013;&#010;&#009;UPDATE clientes cli &#013;&#010;&#009;INNER JOIN unidades u ON (cli.COD_UNIDADE = u.CODIGO) &#013;&#010;&#009;SET cli.COD_CAMPANHA = &#013;&#010;&#009;&#009;IF(DATEDIFF(now(),cli.DATA_ULT_COMPRA)&lt; u.INATIVOS_RECENTES,&#013;&#010;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;ATIVOS&quot;), &#013;&#010;&#009;&#009;&#009;IF(DATEDIFF(now(),cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS,&#013;&#010;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_R&quot;), &#013;&#010;&#009;&#009;&#009;&#009;IF( cli.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;PROSPE&quot;),&#013;&#010;&#009;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_A&quot;)&#013;&#010;&#009;&#009;&#009;&#009;&#009;)&#013;&#010;&#009;&#009;&#009;&#009;)&#013;&#010;&#009;&#009;&#009;);&#013;&#010;  &#013;&#010;&#009;UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)&#013;&#010;&#009;SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND NOT cli.OPERADOR IN (0, -2); &#013;&#010;&#013;&#010;&#009;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;INNER JOIN resultados r ON (r.CODIGO = cc.RESULTADO) &#009;&#013;&#010;&#009;SET cc.CAMPANHA = cli.COD_CAMPANHA, &#013;&#010;&#009;cc.OPERADOR = cli.OPERADOR &#013;&#010;&#009;WHERE cc.CONCLUIDO = &quot;NAO&quot;&#013;&#010;        AND NOT cc.AGENDA IN (-250, -200, -100, -2)&#013;&#010;&#009;AND r.COD_ACAO &lt;&gt; 8 ; &#013;&#010;&#013;&#010;   &#013;&#010;&#009;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;SET &#013;&#010;   &#009;&#009;cc.CAMPANHA = cli.COD_CAMPANHA&#013;&#010;&#009;WHERE &#013;&#010;   &#009;&#009;cc.CONCLUIDO = &quot;NAO&quot;;&#013;&#010;END;"/><ROW RowState="12" CODIGO="50" DATA="20140527" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS_FINALIZA(IN VCLIENTE INT, VOPERADOR INT) &#013;&#010;BEGIN                                                            &#013;&#010;  DECLARE SAI INT DEFAULT 0;                                     &#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);                                  &#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR                                  &#013;&#010;&#009;&#009;(SELECT                                                    &#013;&#010;      &#009;r.FIDELIZARCOTACAO                                     &#013;&#010;      FROM                                                       &#013;&#010;      &#009;campanhas_clientes cc,                                  &#013;&#010;      &#009;resultados r                                            &#013;&#010;      WHERE                                                      &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO                                 &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE                               &#013;&#010;      ORDER BY                                                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC                                   &#013;&#010;      LIMIT 5);                                                  &#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;           &#013;&#010;                                                                 &#013;&#010;  OPEN C_FIDELIZA;                                               &#013;&#010;                                                                 &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP                                          &#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA;&#009;              &#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN                                  &#013;&#010;&#009;&#009;&#009;UPDATE                                                  &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes                                   &#013;&#010;&#009;&#009;&#009;SET                                                     &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR                                 &#013;&#010;&#009;&#009;&#009;WHERE                                                   &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE                                   &#013;&#010;                                                                AND OPERADOR &lt;&gt; -2&#013;&#010;&#009;&#009;&#009;ORDER BY                                                &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC                                          &#013;&#010;&#009;&#009;&#009;LIMIT 1;                                                &#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;                                  &#013;&#010;&#009;&#009;END IF;                                                    &#013;&#010;&#009;&#009;IF SAI = 1 THEN                                            &#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;                            &#013;&#010;      &#009;&#009;END IF;&#009;&#009;                                         &#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;                                     &#013;&#010;  CLOSE C_FIDELIZA;                                              &#013;&#010;END;                                                                      "/><ROW RowState="12" CODIGO="48" DATA="20140527" SQL="CREATE PROCEDURE PR_REPOE_LIGACOES_FIDELIZADAS(IN VCLIENTE INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, OPERADOR_LIGACAO, 0) OPERADOR_LIGACAO    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;&#009;operadores o           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR;&#009;&#013;&#010;&#009;&#009;IF VFIDELIZA = &quot;SIM&quot; THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;                                                                AND OPERADOR &lt;&gt; -2&#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;&#013;&#010;"/><ROW RowState="13" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO()&#013;&#010;BEGIN&#013;&#010;&#009;&#013;&#010;&#009;UPDATE clientes cli &#013;&#010;&#009;INNER JOIN unidades u ON (cli.COD_UNIDADE = u.CODIGO) &#013;&#010;&#009;SET cli.COD_CAMPANHA = &#013;&#010;&#009;&#009;IF(DATEDIFF(now(),cli.DATA_ULT_COMPRA)&lt; u.INATIVOS_RECENTES,&#013;&#010;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;ATIVOS&quot;), &#013;&#010;&#009;&#009;&#009;IF(DATEDIFF(now(),cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS,&#013;&#010;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_R&quot;), &#013;&#010;&#009;&#009;&#009;&#009;IF( cli.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;PROSPE&quot;),&#013;&#010;&#009;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_A&quot;)&#013;&#010;&#009;&#009;&#009;&#009;&#009;)&#013;&#010;&#009;&#009;&#009;&#009;)&#013;&#010;&#009;&#009;&#009;);&#013;&#010;  &#013;&#010;&#009;UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)&#013;&#010;&#009;SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND NOT cli.OPERADOR IN (0); &#013;&#010;&#013;&#010;&#009;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;INNER JOIN resultados r ON (r.CODIGO = cc.RESULTADO) &#009;&#013;&#010;&#009;SET cc.CAMPANHA = cli.COD_CAMPANHA, &#013;&#010;&#009;cc.OPERADOR = cli.OPERADOR &#013;&#010;&#009;WHERE cc.CONCLUIDO = &quot;NAO&quot;&#013;&#010;        AND NOT cc.AGENDA IN (-250, -200, -100, -2)&#013;&#010;&#009;AND r.COD_ACAO &lt;&gt; 8 ; &#013;&#010;&#013;&#010;   &#013;&#010;&#009;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;SET &#013;&#010;   &#009;&#009;cc.CAMPANHA = cli.COD_CAMPANHA&#013;&#010;&#009;WHERE &#013;&#010;   &#009;&#009;cc.CONCLUIDO = &quot;NAO&quot;;&#013;&#010;END;"/><ROW RowState="4" CODIGO="152" DATA="20160501" SQL="INSERT IGNORE INTO acoes &#013;&#010;(codigo, descricao)&#013;&#010;VALUES&#013;&#010;(11, &apos;AUTOMATICO 1 DIA&apos;);"/><ROW RowState="4" CODIGO="153" DATA="20160505" SQL="ALTER TABLE PARAMETROS ADD SIP_EMITE_BIP CHAR(1) DEFAULT &apos;S&apos; NOT NULL;"/><ROW RowState="4" CODIGO="154" DATA="20160505" SQL="ALTER TABLE PARAMETROS ADD SIP_VOLUME_AUTOMATICO CHAR(1) DEFAULT &apos;S&apos; NOT NULL;"/><ROW RowState="4" CODIGO="155" DATA="20160510" SQL="INSERT IGNORE INTO acoes &#013;&#010;(codigo, descricao)&#013;&#010;VALUES&#013;&#010;(12, &apos;AUTOMATICO 7 DIAS&apos;);"/><ROW RowState="4" CODIGO="156" DATA="20160511" SQL="ALTER TABLE parametros ADD VALIDA_AGENDAMENTOS CHAR(1) DEFAULT &apos;S&apos; NOT NULL;"/><ROW RowState="13" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO()&#013;&#010;BEGIN&#013;&#010;&#009;&#013;&#010;&#009;UPDATE clientes cli &#013;&#010;&#009;INNER JOIN unidades u ON (cli.COD_UNIDADE = u.CODIGO) &#013;&#010;&#009;SET cli.COD_CAMPANHA = &#013;&#010;&#009;&#009;IF(DATEDIFF(now(),cli.DATA_ULT_COMPRA)&lt; u.INATIVOS_RECENTES,&#013;&#010;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;ATIVOS&quot;), &#013;&#010;&#009;&#009;&#009;IF(DATEDIFF(now(),cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS,&#013;&#010;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_R&quot;), &#013;&#010;&#009;&#009;&#009;&#009;IF( cli.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;PROSPE&quot;),&#013;&#010;&#009;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_A&quot;)&#013;&#010;&#009;&#009;&#009;&#009;&#009;)&#013;&#010;&#009;&#009;&#009;&#009;)&#013;&#010;&#009;&#009;&#009;);&#013;&#010;  &#013;&#010;&#009;UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)&#013;&#010;&#009;SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND NOT cli.OPERADOR IN (0); &#013;&#010;&#013;&#010;                UPDATE campanhas_clientes cc INNER JOIN campanhas c ON(c.CODIGO = cc.CAMPANHA)&#013;&#010; &#009;SET cc.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND cc.OPERADOR = -2; &#013;&#010;&#013;&#010;&#009;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;INNER JOIN resultados r ON (r.CODIGO = cc.RESULTADO) &#009;&#013;&#010;&#009;SET cc.CAMPANHA = cli.COD_CAMPANHA, &#013;&#010;&#009;cc.OPERADOR = cli.OPERADOR &#013;&#010;&#009;WHERE cc.CONCLUIDO = &quot;NAO&quot;&#013;&#010;        AND NOT cc.AGENDA IN (-250, -200, -100, -2)&#013;&#010;&#009;AND r.COD_ACAO &lt;&gt; 8 ; &#013;&#010;&#013;&#010;   &#013;&#010;&#009;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;SET &#013;&#010;   &#009;&#009;cc.CAMPANHA = cli.COD_CAMPANHA&#013;&#010;&#009;WHERE &#013;&#010;   &#009;&#009;cc.CONCLUIDO = &quot;NAO&quot;;&#013;&#010;END;"/><ROW RowState="13" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO()&#013;&#010;BEGIN&#013;&#010;&#009;&#013;&#010;&#009;UPDATE clientes cli &#013;&#010;&#009;INNER JOIN unidades u ON (cli.COD_UNIDADE = u.CODIGO) &#013;&#010;&#009;SET cli.COD_CAMPANHA = &#013;&#010;&#009;&#009;IF(DATEDIFF(now(),cli.DATA_ULT_COMPRA)&lt; u.INATIVOS_RECENTES,&#013;&#010;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;ATIVOS&quot;), &#013;&#010;&#009;&#009;&#009;IF(DATEDIFF(now(),cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS,&#013;&#010;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_R&quot;), &#013;&#010;&#009;&#009;&#009;&#009;IF( cli.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;PROSPE&quot;),&#013;&#010;&#009;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_A&quot;)&#013;&#010;&#009;&#009;&#009;&#009;&#009;)&#013;&#010;&#009;&#009;&#009;&#009;)&#013;&#010;&#009;&#009;&#009;);&#013;&#010;  &#013;&#010;&#009;UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)&#013;&#010;&#009;SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND NOT cli.OPERADOR IN (0); &#013;&#010;&#013;&#010;                UPDATE campanhas_clientes cc INNER JOIN campanhas c ON(c.CODIGO = cc.CAMPANHA)&#013;&#010; &#009;SET cc.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND cc.OPERADOR = -2; &#013;&#010;&#013;&#010;&#009;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;LEFT JOIN resultados r ON (r.CODIGO = cc.RESULTADO AND r.COD_ACAO &lt;&gt; 8)&#013;&#010;&#009;SET cc.CAMPANHA = cli.COD_CAMPANHA, &#013;&#010;&#009;cc.OPERADOR = cli.OPERADOR &#013;&#010;&#009;WHERE cc.CONCLUIDO = &quot;NAO&quot;&#013;&#010;                 AND NOT cc.AGENDA IN (-250, -200, -100, -2); &#013;&#010;&#013;&#010;   &#013;&#010;&#009;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;SET &#013;&#010;   &#009;&#009;cc.CAMPANHA = cli.COD_CAMPANHA&#013;&#010;&#009;WHERE &#013;&#010;   &#009;&#009;cc.CONCLUIDO = &quot;NAO&quot;;&#013;&#010;END;"/><ROW RowState="5" CODIGO="157" DATA="20160522" SQL="ALTER TABLE parametros ADD(&#013;&#010;&#009;RAZAO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL,&#013;&#010;&#009;FANTASIA &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CNPJ &#009;&#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;ENDERECO &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;BAIRRO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CIDADE &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CEP &#009;&#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;ESTADO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;TELEFONE &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;EMAIL &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;UNIDADE &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;SEGUIMENTO &#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL,&#013;&#010;&#009;CONTATO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;EMAIL_CONTATO &#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CARGO_CONTATO &#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;TEL_CONTATO &#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;SALDO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL,&#013;&#010;&#009;POTENCIAL &#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL);&#013;&#010;"/><ROW RowState="13" CODIGO="157" DATA="20160522" SQL="ALTER TABLE parametros ADD(&#013;&#010;&#009;RAZAO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL,&#013;&#010;&#009;FANTASIA &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CNPJ &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;ENDERECO &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;BAIRRO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CIDADE &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CEP &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;ESTADO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;TELEFONE &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;EMAIL &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;UNIDADE &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;SEGUIMENTO &#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL,&#013;&#010;&#009;CONTATO &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;EMAIL_CONTATO &#009;                CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CARGO_CONTATO &#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;TEL_CONTATO &#009;                CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;SALDO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL,&#013;&#010;&#009;POTENCIAL &#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL);&#013;&#010;"/><ROW RowState="12" CODIGO="157" DATA="20160522" SQL="ALTER TABLE parametros ADD(&#013;&#010;&#009;RAZAO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL,&#013;&#010;&#009;FANTASIA &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CNPJ &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;ENDERECO &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;BAIRRO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CIDADE &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CEP &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;ESTADO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;TELEFONE &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;EMAIL &#009;&#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;UNIDADE &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;SEGMENTO &#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL,&#013;&#010;&#009;CONTATO &#009;&#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;EMAIL_CONTATO &#009;                CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;CARGO_CONTATO &#009;CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;TEL_CONTATO &#009;                CHAR(1) DEFAULT &apos;N&apos; NOT NULL,&#013;&#010;&#009;SALDO &#009;&#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL,&#013;&#010;&#009;POTENCIAL &#009;&#009;CHAR(1) DEFAULT &apos;S&apos; NOT NULL);&#013;&#010;"/><ROW RowState="5" CODIGO="158" DATA="20160530" SQL="CREATE INDEX IDX_CAMPANHAS_CLIENTES ON campanhas_clientes(CONCLUIDO, OPERADOR, OPERADOR_LIGACAO, ORDEM, CLIENTE, CAMPANHA, DT_AGENDAMENTO);&#013;&#010;&#013;&#010;"/><ROW RowState="4" CODIGO="159" DATA="20160530" SQL="CREATE INDEX IDX_CLIENTES ON clientes(ATIVO, COD_CAMPANHA);"/><ROW RowState="12" CODIGO="54" DATA="20140527" SQL="CREATE PROCEDURE PR_ORGANIZA_ATUALIZACAO()&#013;&#010;BEGIN&#013;&#010;&#009;&#013;&#010;&#009;UPDATE clientes cli &#013;&#010;&#009;INNER JOIN unidades u ON (cli.COD_UNIDADE = u.CODIGO) &#013;&#010;&#009;SET cli.COD_CAMPANHA = &#013;&#010;&#009;&#009;IF(DATEDIFF(now(),cli.DATA_ULT_COMPRA)&lt; u.INATIVOS_RECENTES,&#013;&#010;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;ATIVOS&quot;), &#013;&#010;&#009;&#009;&#009;IF(DATEDIFF(now(),cli.DATA_ULT_COMPRA) &lt; u.INATIVOS_ANTIGOS,&#013;&#010;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_R&quot;), &#013;&#010;&#009;&#009;&#009;&#009;IF( cli.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;PROSPE&quot;),&#013;&#010;&#009;&#009;&#009;&#009;&#009;(SELECT CODIGO FROM campanhas WHERE UNIDADE = cli.COD_UNIDADE AND TIPO = &quot;INAT_A&quot;)&#013;&#010;&#009;&#009;&#009;&#009;&#009;)&#013;&#010;&#009;&#009;&#009;&#009;)&#013;&#010;&#009;&#009;&#009;);&#013;&#010;  &#013;&#010;&#009;UPDATE clientes cli INNER JOIN campanhas c ON(c.CODIGO = cli.COD_CAMPANHA)&#013;&#010;&#009;SET cli.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND NOT cli.OPERADOR = 0; &#013;&#010;&#013;&#010;                UPDATE campanhas_clientes cc INNER JOIN campanhas c ON(c.CODIGO = cc.CAMPANHA)&#013;&#010; &#009;SET cc.OPERADOR = 0 WHERE c.TIPO IN (&quot;INAT_R&quot;, &quot;INAT_A&quot;, &quot;PROSPE&quot;) AND cc.OPERADOR = -2; &#013;&#010;&#013;&#010;&#009;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;LEFT JOIN resultados r ON (r.CODIGO = cc.RESULTADO AND r.COD_ACAO &lt;&gt; 8)&#013;&#010;&#009;SET cc.CAMPANHA = cli.COD_CAMPANHA, &#013;&#010;&#009;cc.OPERADOR = cli.OPERADOR &#013;&#010;&#009;WHERE cc.CONCLUIDO = &quot;NAO&quot;&#013;&#010;                 AND NOT cc.AGENDA IN (-250, -200, -100, -2); &#013;&#010;&#013;&#010;   &#013;&#010;&#009;UPDATE campanhas_clientes cc &#013;&#010;&#009;INNER JOIN clientes cli ON (cli.CODIGO = cc.CLIENTE) &#013;&#010;&#009;SET &#013;&#010;   &#009;&#009;cc.CAMPANHA = cli.COD_CAMPANHA&#013;&#010;&#009;WHERE &#013;&#010;   &#009;&#009;cc.CONCLUIDO = &quot;NAO&quot;;&#013;&#010;END;"/><ROW RowState="4" CODIGO="160" DATA="20160602" SQL="CREATE INDEX IDX_CLIENTES_RAZAO ON clientes(RAZAO);"/><ROW RowState="12" CODIGO="158" DATA="20160530" SQL="DROP INDEX IDX_CAMPANHAS_CLIENTES ON campanhas_clientes;&#013;&#010;&#013;&#010;"/><ROW RowState="4" CODIGO="161" DATA="20160607" SQL="CREATE INDEX IDX_CAMPANHAS_CONCLUIDO ON campanhas_clientes(CONCLUIDO);&#013;&#010;"/><ROW RowState="4" CODIGO="162" DATA="20160607" SQL="CREATE INDEX IDX_CAMPANHAS_ORDEM ON campanhas_clientes(ORDEM);&#013;&#010;&#013;&#010;&#013;&#010;"/><ROW RowState="4" CODIGO="163" DATA="20160607" SQL="CREATE INDEX IDX_CAMPANHAS_CAMPANHA ON campanhas_clientes(CAMPANHA);&#013;&#010;&#013;&#010;"/><ROW RowState="4" CODIGO="164" DATA="20160607" SQL="CREATE INDEX IDX_CAMPANHAS_DT_AGENDAMENTO ON campanhas_clientes(DT_AGENDAMENTO);"/><ROW RowState="4" CODIGO="165" DATA="20160718" SQL="insert ignore into fone_digito values (&apos;DF&apos;,&apos;61&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="166" DATA="20160718" SQL="insert ignore into fone_digito values (&apos;GO&apos;,&apos;62&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="167" DATA="20160718" SQL="insert ignore into fone_digito values (&apos;GO&apos;,&apos;64&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="168" DATA="20160718" SQL="insert ignore into fone_digito values (&apos;GO&apos;,&apos;65&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="169" DATA="20160718" SQL="insert ignore into fone_digito values (&apos;TO&apos;,&apos;63&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="170" DATA="20160718" SQL="insert ignore into fone_digito values (&apos;MT&apos;,&apos;66&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="171" DATA="20160718" SQL="insert ignore into fone_digito values (&apos;MS&apos;,&apos;67&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="172" DATA="20160718" SQL="insert ignore into fone_digito values (&apos;AC&apos;,&apos;68&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="173" DATA="20160718" SQL="insert ignore into fone_digito values (&apos;RO&apos;,&apos;69&apos;,&apos;9&apos;);&#013;&#010;"/><ROW RowState="6" CODIGO="174" DATA="20160718" SQL="DROP TRIGGER `BU_ERP_NULL_ALTERACOES`;&#013;&#010;"/><ROW RowState="4" CODIGO="175" DATA="20160718" SQL="ALTER TABLE `alteracoes_clientes`  DROP COLUMN `OPERADOR`;&#013;&#010;"/><ROW RowState="4" CODIGO="176" DATA="20160718" SQL="ALTER TABLE `alteracoes_clientes`  ADD COLUMN `OPERADOR_LOGIN` VARCHAR(255) NULL DEFAULT NULL AFTER `CODIGO_ERP`;&#013;&#010;"/><ROW RowState="4" CODIGO="177" DATA="20160718" SQL="ALTER TABLE `clientes`  ADD COLUMN `OPERADOR_LOGIN` VARCHAR(255) NULL DEFAULT NULL AFTER `ATUALIZADOR`;&#013;&#010;"/><ROW RowState="6" CODIGO="178" DATA="20160718" SQL="DELIMITER //&#013;&#010;CREATE TRIGGER `BU_ERP_NULL_ALTERACOES` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN                                                                                                      &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN                                                                                                                                                                       &#013;&#010;    SET NEW.COD_ERP = NULL;                                                                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                              &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;                                                                                                                                                          &#013;&#010; END//&#013;&#010;DELIMITER ;"/><ROW RowState="4" CODIGO="179" DATA="20160722" SQL="ALTER TABLE `config_mail`  ADD COLUMN `TLS` ENUM(&apos;SIM&apos;,&apos;NÃO&apos;) NULL DEFAULT &apos;NÃO&apos; AFTER `SSL`;"/><ROW RowState="4" CODIGO="180" DATA="20160722" SQL="DROP TRIGGER `BU_ERP_NULL_ALTERACOES`;"/><ROW RowState="6" CODIGO="181" DATA="20160722" SQL="DELIMITER //&#013;&#010;CREATE TRIGGER `BU_ERP_NULL_ALTERACOES` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN                                                                                                      &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN                                                                                                                                                                       &#013;&#010;    SET NEW.COD_ERP = NULL;                                                                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                              &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;                                                                                                                                                          &#013;&#010; END//&#013;&#010;DELIMITER ;&#013;&#010;"/><ROW RowState="13" CODIGO="1" DATA="20140527" SQL="CREATE TABLE atualiza_campos (&#009;CAMPO VARCHAR(30) NOT NULL, ATUALIZAR VARCHAR(1) NOT NULL DEFAULT &quot;S&quot;, PRIMARY KEY (CAMPO) );&#013;&#010;"/><ROW RowState="12" CODIGO="1" DATA="20140527" SQL="CREATE TABLE atualiza_campos (&#009;CAMPO VARCHAR(30) NOT NULL, ATUALIZAR VARCHAR(1) NOT NULL DEFAULT &quot;S&quot;, PRIMARY KEY (CAMPO) );&#013;&#010;&#013;&#010;"/><ROW RowState="6" CODIGO="182" DATA="20160819" SQL="DROP TRIGGER `BU_ERP_NULL_ALTERACOES`;"/><ROW RowState="4" CODIGO="183" DATA="20160819" SQL="ALTER TABLE `alteracoes_clientes`  DROP COLUMN `OPERADOR`;"/><ROW RowState="4" CODIGO="184" DATA="20160819" SQL="ALTER TABLE `alteracoes_clientes`  ADD COLUMN `OPERADOR_LOGIN` VARCHAR(255) NULL DEFAULT NULL AFTER `CODIGO_ERP`;"/><ROW RowState="4" CODIGO="185" DATA="20160819" SQL="ALTER TABLE `clientes`  ADD COLUMN `OPERADOR_LOGIN` VARCHAR(255) NULL DEFAULT NULL AFTER `ATUALIZADOR`;"/><ROW RowState="5" CODIGO="186" DATA="20160819" SQL="DELIMITER //&#013;&#010;CREATE TRIGGER `BU_ERP_NULL_ALTERACOES` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN                                                                                                      &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN                                                                                                                                                                       &#013;&#010;    SET NEW.COD_ERP = NULL;                                                                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                              &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;                                                                                                                                                          &#013;&#010; END//&#013;&#010;DELIMITER ;&#013;&#010;"/><ROW RowState="4" CODIGO="187" DATA="20160819" SQL="ALTER TABLE `config_mail`  ADD COLUMN `TLS` ENUM(&apos;SIM&apos;,&apos;NÃO&apos;) NULL DEFAULT &apos;NÃO&apos; AFTER `SSL`;"/><ROW RowState="14" CODIGO="186" DATA="20160819" SQL="DELIMITER //&#013;&#010;CREATE TRIGGER `BU_ERP_NULL_ALTERACOES` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN                                                                                                      &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN                                                                                                                                                                       &#013;&#010;    SET NEW.COD_ERP = NULL;                                                                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                              &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;                                                                                                                                                          &#013;&#010; END//&#013;&#010;DELIMITER ;&#013;&#010;"/><ROW RowState="5" CODIGO="188" DATA="20160822" SQL="CREATE TABLE IF NOT EXISTS `fase_contato` (&#013;&#010;  `CODIGO` int(10) NOT NULL,&#013;&#010;  `NOME` varchar(50) DEFAULT NULL,&#013;&#010;  PRIMARY KEY (`CODIGO`)&#013;&#010;) ENGIN"/><ROW RowState="4" CODIGO="189" DATA="20160822" SQL="ALTER TABLE `historico_cli`  ADD COLUMN `CODIGO_FASE_CONTATO` INT(10) NULL AFTER `CLIENTE`;"/><ROW RowState="5" CODIGO="190" DATA="20160822" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (1, &apos;CONTATO INICIAL&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (2, &apos;ENVIO DE CATALOGO&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (3, &apos;RETORNO DE CATALOGO&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (4, &apos;MANUTENCAO&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (5, &apos;FOLLOW COTACAO&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (6, &apos;POS VENDA&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (7, &apos;CAMPANHA&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (8, &apos;NEGOCIACAO&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (9, &apos;RECEPTIVO&apos;);"/><ROW RowState="4" CODIGO="191" DATA="20160825" SQL="INSERT INTO `acoes` (`codigo`, `descricao`) VALUES (13, &apos;AUTOMATICO 3 MESES&apos;);&#013;&#010;"/><ROW RowState="5" CODIGO="192" DATA="20160825" SQL="ALTER TABLE `campanhas_clientes`  ADD COLUMN `DESC_FONE1` VARCHAR(30) NULL AFTER `AGENDA`;&#013;&#010;ALTER TABLE `campanhas_clientes`  ADD COLUMN `DESC_FONE2` VARCHAR(30) NULL AFTER `DESC_FONE1`;&#013;&#010;ALTER TABLE `campanhas_clientes`  ADD COLUMN `DESC_FONE3` VARCHAR(30) NULL AFTER `DESC_FON"/><ROW RowState="12" CODIGO="192" DATA="20160825" SQL="ALTER TABLE `campanhas_clientes`  ADD COLUMN `DESC_FONE1` VARCHAR(30) NULL AFTER `AGENDA`;&#013;&#010;"/><ROW RowState="4" CODIGO="193" DATA="20160825" SQL="ALTER TABLE `campanhas_clientes`  ADD COLUMN `DESC_FONE2` VARCHAR(30) NULL AFTER `DESC_FONE1`;&#013;&#010;"/><ROW RowState="4" CODIGO="194" DATA="20160825" SQL="ALTER TABLE `campanhas_clientes`  ADD COLUMN `DESC_FONE3` VARCHAR(30) NULL AFTER `DESC_FONE2`;"/><ROW RowState="4" CODIGO="195" DATA="20160825" SQL="DROP PROCEDURE IF EXISTS `PR_REPOE_LIGACOES_FIDELIZADAS`;"/><ROW RowState="4" CODIGO="196" DATA="20160825" SQL="CREATE DEFINER=`root`@`localhost` PROCEDURE `PR_REPOE_LIGACOES_FIDELIZADAS`(IN `VCLIENTE` INT&#013;&#010;)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE VCOD_ACAO INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, OPERADOR_LIGACAO, 0) OPERADOR_LIGACAO,&#013;&#010;&#009;&#009;&#009;r.COD_ACAO&#009;&#009;&#009;    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;      &#009;operadores o&#009;&#009;&#009;           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;&#009;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;       &#009;AND r.ECONTATO = &apos;SIM&apos; &#009;&#009;&#009;   &#009;&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR, VCOD_ACAO;&#009;&#013;&#010;&#009;&#009;IF (VFIDELIZA = &quot;SIM&quot;) AND (VCOD_ACAO &lt;&gt; 1) THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;            AND OPERADOR &lt;&gt; -2&#013;&#010;            AND AGENDA NOT IN (-250,-260,-270,-240,-100)&#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END;"/><ROW RowState="4" CODIGO="197" DATA="20160825" SQL="DROP PROCEDURE IF EXISTS `PR_REPOE_LIGACOES_FIDELIZADAS_FINALIZA`;"/><ROW RowState="4" CODIGO="198" DATA="20160825" SQL="CREATE DEFINER=`root`@`%` PROCEDURE `PR_REPOE_LIGACOES_FIDELIZADAS_FINALIZA`(IN `VCLIENTE` INT, IN `VOPERADOR` INT)&#013;&#010;BEGIN                                                            &#013;&#010;  DECLARE SAI INT DEFAULT 0;  &#013;&#010;  DECLARE VCOD_ACAO INT;                                   &#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);                                  &#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR                                  &#013;&#010;&#009;&#009;(SELECT                                                    &#013;&#010;      &#009;r.FIDELIZARCOTACAO, r.COD_ACAO                                     &#013;&#010;      FROM                                                       &#013;&#010;      &#009;campanhas_clientes cc,                                  &#013;&#010;      &#009;resultados r                                            &#013;&#010;      WHERE                                                      &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO                                 &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE    &#013;&#010;&#009;&#009;   AND r.ECONTATO = &apos;SIM&apos;                           &#013;&#010;      ORDER BY                                                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC                                   &#013;&#010;      LIMIT 5);                                                  &#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;           &#013;&#010;                                                                 &#013;&#010;  OPEN C_FIDELIZA;                                               &#013;&#010;                                                                 &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP                                          &#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VCOD_ACAO;              &#013;&#010;&#009;&#009;IF (VFIDELIZA = &quot;SIM&quot;) and (VCOD_ACAO &lt;&gt; 1) THEN                                  &#013;&#010;&#009;&#009;&#009;UPDATE                                                  &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes                                   &#013;&#010;&#009;&#009;&#009;SET                                                     &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR                                 &#013;&#010;&#009;&#009;&#009;WHERE                                                   &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE                                   &#013;&#010;            AND OPERADOR &lt;&gt; -2&#013;&#010;            AND AGENDA NOT IN (-270,-260,-250,-240,-100)&#013;&#010;&#009;&#009;&#009;ORDER BY                                                &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC                                          &#013;&#010;&#009;&#009;&#009;LIMIT 1;                                                &#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;                                  &#013;&#010;&#009;&#009;END IF;                                                    &#013;&#010;&#009;&#009;IF SAI = 1 THEN                                            &#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;                            &#013;&#010;      &#009;&#009;END IF;&#009;&#009;                                         &#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;                                     &#013;&#010;  CLOSE C_FIDELIZA;                                              &#013;&#010;END;"/><ROW RowState="5" CODIGO="199" DATA="20160826" SQL="DELIMITER //&#013;&#010;CREATE TRIGGER `BU_ERP_NULL_ALTERACOES` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN                                                                                                      &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN                                                                                                                                                                       &#013;&#010;    SET NEW.COD_ERP = NULL;                                                                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                              &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;                                                                                                                                                          &#013;&#010; END//&#013;&#010;DELIMITER ;&#013;&#010;"/><ROW RowState="13" CODIGO="199" DATA="20160826" SQL="&#013;&#010;CREATE TRIGGER `BU_ERP_NULL_ALTERACOES` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN                                                                                                      &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN                                                                                                                                                                       &#013;&#010;    SET NEW.COD_ERP = NULL;                                                                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                              &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;                                                                                                                                                          &#013;&#010; END&#013;&#010;"/><ROW RowState="12" CODIGO="199" DATA="20160826" SQL="CREATE TRIGGER `BU_ERP_NULL_ALTERACOES` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN                                                                                                      &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN                                                                                                                                                                       &#013;&#010;    SET NEW.COD_ERP = NULL;                                                                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                              &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;                                                                                                                                                          &#013;&#010; END&#013;&#010;"/><ROW RowState="12" CODIGO="188" DATA="20160822" SQL="CREATE TABLE IF NOT EXISTS `fase_contato` (&#013;&#010;  `CODIGO` int(10) NOT NULL,&#013;&#010;  `NOME` varchar(50) DEFAULT NULL,&#013;&#010;  PRIMARY KEY (`CODIGO`)&#013;&#010;) ENGINE=InnoDB DEFAULT CHARSET=utf8;&#013;&#010;"/><ROW RowState="14" CODIGO="190" DATA="20160822" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (1, &apos;CONTATO INICIAL&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (2, &apos;ENVIO DE CATALOGO&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (3, &apos;RETORNO DE CATALOGO&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (4, &apos;MANUTENCAO&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (5, &apos;FOLLOW COTACAO&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (6, &apos;POS VENDA&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (7, &apos;CAMPANHA&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (8, &apos;NEGOCIACAO&apos;);&#013;&#010;INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (9, &apos;RECEPTIVO&apos;);"/><ROW RowState="4" CODIGO="200" DATA="20160901" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (1, &apos;CONTATO INICIAL&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="201" DATA="20160901" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (2, &apos;ENVIO DE CATALOGO&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="202" DATA="20160901" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (3, &apos;RETORNO DE CATALOGO&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="203" DATA="20160901" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (4, &apos;MANUTENCAO&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="204" DATA="20160901" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (5, &apos;FOLLOW COTACAO&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="205" DATA="20160901" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (6, &apos;POS VENDA&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="206" DATA="20160901" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (7, &apos;CAMPANHA&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="207" DATA="20160901" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (8, &apos;NEGOCIACAO&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="208" DATA="20160901" SQL="INSERT INTO `fase_contato` (`CODIGO`, `NOME`) VALUES (9, &apos;RECEPTIVO&apos;);"/><ROW RowState="4" CODIGO="209" DATA="20160901" SQL="INSERT INTO `acoes` (`codigo`, `descricao`) VALUES (14, &apos;ENVIAR EMAIL AUTOMATICO 1 DIA&apos;);&#013;&#010;"/><ROW RowState="4" CODIGO="210" DATA="20160906" SQL="INSERT INTO `acoes` (`codigo`, `descricao`) VALUES (13, &apos;AUTOMATICO 3 MESES&apos;);&#013;&#010;"/><ROW RowState="6" CODIGO="211" DATA="20160906" SQL="INSERT INTO `acoes` (`codigo`, `descricao`) VALUES (14, &apos;ENVIAR E-MAIL E AUTOMATICO 1 DIA&apos;);"/><ROW RowState="4" CODIGO="212" DATA="20160906" SQL="ALTER TABLE alteracoes_clientes MODIFY VALOR_ANTIGO VARCHAR(600);&#013;&#010;"/><ROW RowState="4" CODIGO="213" DATA="20160906" SQL="ALTER TABLE alteracoes_clientes MODIFY VALOR_NOVO VARCHAR(600);"/><ROW RowState="4" CODIGO="214" DATA="20160912" SQL="ALTER TABLE `parametros`  ADD COLUMN `AGENDAMENTO_SUPERVISOR` CHAR(1) NOT NULL DEFAULT &apos;N&apos; AFTER `POTENCIAL`;&#013;&#010;&#013;&#010;"/><ROW RowState="4" CODIGO="215" DATA="20160912" SQL="ALTER TABLE `motivos_pausa`  ADD COLUMN `PRODUTIVIDADE` ENUM(&apos;SIM&apos;,&apos;NAO&apos;) NULL DEFAULT &apos;SIM&apos; AFTER `TEMPO_MAX_SEG`;"/><ROW RowState="4" CODIGO="216" DATA="20160915" SQL="ALTER TABLE `parametros`  ADD COLUMN `DDD_LOCAL` CHAR(2);"/><ROW RowState="4" CODIGO="217" DATA="20160915" SQL="ALTER TABLE `parametros`  ADD COLUMN `OPERADORA_LOCAL` CHAR(3);"/><ROW RowState="4" CODIGO="218" DATA="20160915" SQL="DROP PROCEDURE `PR_REPOE_LIGACOES_FIDELIZADAS`;"/><ROW RowState="5" CODIGO="219" DATA="20160915" SQL="DELIMITER //&#013;&#010;CREATE DEFINER=`root`@`localhost` PROCEDURE `PR_REPOE_LIGACOES_FIDELIZADAS`(IN `VCLIENTE` INT&#013;&#010;)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE VCOD_ACAO INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, OPERADOR_LIGACAO, IF(OPERADOR = OPERADOR_LIGACAO, OPERADOR_LIGACAO,0)) OPERADOR_LIGACAO,&#013;&#010;&#009;&#009;&#009;r.COD_ACAO&#009;&#009;&#009;    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;      &#009;operadores o&#009;&#009;&#009;           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;&#009;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;       &#009;AND r.ECONTATO = &apos;SIM&apos; &#009;&#009;&#009;   &#009;&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR, VCOD_ACAO;&#009;&#013;&#010;&#009;&#009;IF (VFIDELIZA = &quot;SIM&quot;) AND (VCOD_ACAO &lt;&gt; 1) THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;            AND OPERADOR &lt;&gt; -2&#013;&#010;            AND AGENDA NOT IN (-250,-260, -270, -240)&#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END//&#013;&#010;DELIMITER ;"/><ROW RowState="12" CODIGO="219" DATA="20160915" SQL="CREATE DEFINER=`root`@`localhost` PROCEDURE `PR_REPOE_LIGACOES_FIDELIZADAS`(IN `VCLIENTE` INT&#013;&#010;)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE VCOD_ACAO INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT        &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;IF(o.ATIVO = &apos;SIM&apos;, OPERADOR_LIGACAO, IF(OPERADOR = OPERADOR_LIGACAO, OPERADOR_LIGACAO,0)) OPERADOR_LIGACAO,&#013;&#010;&#009;&#009;&#009;r.COD_ACAO&#009;&#009;&#009;    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;      &#009;operadores o&#009;&#009;&#009;           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;&#009;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;       &#009;AND r.ECONTATO = &apos;SIM&apos; &#009;&#009;&#009;   &#009;&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR, VCOD_ACAO;&#009;&#013;&#010;&#009;&#009;IF (VFIDELIZA = &quot;SIM&quot;) AND (VCOD_ACAO &lt;&gt; 1) THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = VOPERADOR   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;            AND OPERADOR &lt;&gt; -2&#013;&#010;            AND AGENDA NOT IN (-250,-260, -270, -240)&#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;END"/><ROW RowState="4" CODIGO="220" DATA="20160927" SQL="ALTER TABLE `parametros`  ADD COLUMN `PESQUISAR_CLIENTES_NO_ATIVO` CHAR(1) NULL;"/><ROW RowState="5" CODIGO="221" DATA="20161006" SQL="DROP TRIGGER IF EXISTS BU_ERP_NULL_ALTERACOES;"/><ROW RowState="4" CODIGO="222" DATA="20161006" SQL="DROP TRIGGER IF EXISTS `BI_ERP_NULL`;"/><ROW RowState="4" CODIGO="223" DATA="20161006" SQL="DROP TRIGGER IF EXISTS `tg_clientes_alt`;"/><ROW RowState="4" CODIGO="224" DATA="20161006" SQL="DROP TRIGGER IF EXISTS `tg_clientes_add`;"/><ROW RowState="4" CODIGO="225" DATA="20161006" SQL="DROP TRIGGER IF EXISTS `tg_campanhas_clientes_new`;"/><ROW RowState="4" CODIGO="226" DATA="20161006" SQL="DROP TRIGGER IF EXISTS `tg_campanhas_clientes_alt`;"/><ROW RowState="5" CODIGO="227" DATA="20161006" SQL="CREATE TRIGGER `tg_campanhas_clientes_alt` BEFORE UPDATE ON `campanhas_clientes` FOR EACH ROW &#013;&#010;BEGIN  &#013;&#010;  IF (NEW.CONCLUIDO = &quot;NAO&quot;) THEN   &#013;&#010;    SET NEW.OPERADOR_LIGACAO = 0;  &#013;&#010;  END IF; &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; NEW.OPERADOR_LIGACAO AND NEW.CONCLUIDO = &quot;SIM&quot; AND NEW.OPERADOR &gt; 0 AND&#013;&#010;   exists(SELECT CODIGO FROM propostas  WHERE LIGACAO = NEW.CODIGO LIMIT 1) THEN&#013;&#010;    SET NEW.OPERADOR_LIGACAO = NEW.OPERADOR; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF NEW.AGENDA = -1 THEN&#013;&#010;    SET NEW.AGENDA = 0;&#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  #SET @OPERADOR_CLIENTE = 0;     &#013;&#010;  #SELECT OPERADOR FROM clientes WHERE CODIGO = NEW.CLIENTE INTO @OPERADOR_CLIENTE;&#013;&#010;  &#013;&#010;  #IF NEW.CONCLUIDO = &quot;NAO&quot; AND NEW.OPERADOR &lt;&gt; 0 AND NEW.OPERADOR &lt;&gt; @OPERADOR_CLIENTE AND @OPERADOR_CLIENTE &lt;&gt; -2 THEN&#013;&#010;  #   SET NEW.OPERADOR = @OPERADOR_CLIENTE;&#013;&#010;  #END IF;   &#013;&#010;END;"/><ROW RowState="5" CODIGO="228" DATA="20161006" SQL="CREATE TRIGGER `tg_campanhas_clientes_new` BEFORE INSERT ON `campanhas_clientes` FOR EACH ROW &#013;&#010;BEGIN  &#013;&#010;  IF (NEW.CONCLUIDO = &quot;NAO&quot;) THEN   &#013;&#010;    SET NEW.OPERADOR_LIGACAO = 0;  &#013;&#010;  END IF; &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; NEW.OPERADOR_LIGACAO AND NEW.CONCLUIDO = &quot;SIM&quot; AND NEW.OPERADOR &gt; 0 AND&#013;&#010;   exists(SELECT CODIGO FROM propostas  WHERE LIGACAO = NEW.CODIGO LIMIT 1) THEN&#013;&#010;    SET NEW.OPERADOR_LIGACAO = NEW.OPERADOR; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF NEW.AGENDA = -1 THEN&#013;&#010;    SET NEW.AGENDA = 0;&#013;&#010;  END IF;  &#013;&#010;&#013;&#010;  #SET @OPERADOR_CLIENTE = 0;     &#013;&#010;  #SELECT OPERADOR FROM clientes WHERE CODIGO = NEW.CLIENTE INTO @OPERADOR_CLIENTE;&#013;&#010;  &#013;&#010;  #IF NEW.CONCLUIDO = &quot;NAO&quot; AND NEW.OPERADOR &lt;&gt; 0 AND NEW.OPERADOR &lt;&gt; @OPERADOR_CLIENTE AND @OPERADOR_CLIENTE &lt;&gt; -2 THEN&#013;&#010;  #   SET NEW.OPERADOR = @OPERADOR_CLIENTE;&#013;&#010;  #END IF;&#013;&#010;END;"/><ROW RowState="5" CODIGO="229" DATA="20161006" SQL="CREATE TRIGGER `tg_clientes_add` BEFORE INSERT ON `clientes` FOR EACH ROW BEGIN&#013;&#010;  IF LENGTH(CONCAT(NEW.AREA1,NEW.FONE1)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA1,NEW.FONE1),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA2,NEW.FONE2)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA2,NEW.FONE2),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA3,NEW.FONE3)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA3,NEW.FONE3),&quot;Cliente&quot;);&#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN &#013;&#010;    SET NEW.COD_ERP = NULL; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;END;"/><ROW RowState="5" CODIGO="230" DATA="20161006" SQL="CREATE TRIGGER `tg_clientes_alt` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN  &#013;&#010;  IF (NEW.COD_ERP = &quot;&quot;) THEN   &#013;&#010;    SET NEW.COD_ERP = null;  &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA1,NEW.FONE1)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA1,NEW.FONE1),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA2,NEW.FONE2)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA2,NEW.FONE2),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA3,NEW.FONE3)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA3,NEW.FONE3),&quot;Cliente&quot;);&#013;&#010;  END IF;&#013;&#010;  &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;&#013;&#010;  &#013;&#010;END;"/><ROW RowState="4" CODIGO="231" DATA="20161006" SQL="CREATE TABLE `chat` (&#013;&#010;&#009;`CODIGO` INT(10) NOT NULL AUTO_INCREMENT,&#013;&#010;&#009;`DATA` DATE NOT NULL,&#013;&#010;&#009;`HORA` TIME NOT NULL,&#013;&#010;&#009;`OPERADOR_ENVIO` INTEGER NOT NULL,&#013;&#010;&#009;`OPERADOR_RECEBIDO` INTEGER NOT NULL,&#013;&#010;&#009;`MSG` VARCHAR(255) NOT NULL,&#013;&#010;&#009;`MSG_LIDA` CHAR(1) NOT NULL DEFAULT &apos;N&apos;,&#013;&#010;&#009;PRIMARY KEY (`CODIGO`),&#013;&#010;&#009;INDEX `DATA` (`DATA`),&#013;&#010;&#009;INDEX `FK_OPERADOR_ENVIO` (`OPERADOR_ENVIO`),&#013;&#010;&#009;INDEX `FK_OPERADOR_RECEBIDO` (`OPERADOR_RECEBIDO`),&#013;&#010;&#009;CONSTRAINT `FK_OPERADOR_ENVIO` FOREIGN KEY (`OPERADOR_ENVIO`) REFERENCES `operadores` (`CODIGO`),&#013;&#010;&#009;CONSTRAINT `FK_OPERADOR_RECEBIDO` FOREIGN KEY (`OPERADOR_RECEBIDO`) REFERENCES `operadores` (`CODIGO`)&#009;&#013;&#010;)&#013;&#010;COLLATE=&apos;latin1_swedish_ci&apos;&#013;&#010;ENGINE=InnoDB&#013;&#010;ROW_FORMAT=DEFAULT"/><ROW RowState="6" CODIGO="232" DATA="20161013" SQL="ALTER TABLE `fase_contato`  ADD COLUMN `EXIGE_OBSERVACAO` CHAR(1) NULL;"/><ROW RowState="4" CODIGO="233" DATA="20161013" SQL="ALTER TABLE `parametros`  ADD COLUMN `TEMPO_LIBERAR` INT NULL;"/><ROW RowState="4" CODIGO="234" DATA="20161013" SQL="ALTER TABLE `parametros`  ADD COLUMN `EXIBIR_PRODUTIVIDADE` CHAR(1) NULL;"/><ROW RowState="4" CODIGO="235" DATA="20161013" SQL="ALTER TABLE `parametros`  ADD COLUMN `EXIBIR_PEDIDOS_FECHADOS` CHAR(1) NULL;"/><ROW RowState="4" CODIGO="236" DATA="20161013" SQL="ALTER TABLE `parametros`  ADD COLUMN `EXIGIR_FASE_CONTATO` CHAR(1) NULL;"/><ROW RowState="4" CODIGO="237" DATA="20161013" SQL="ALTER TABLE `fase_contato`  ADD COLUMN `EXIGE_OBSERVACAO` CHAR(1) NULL;"/><ROW RowState="13" CODIGO="227" DATA="20161006" SQL="CREATE TRIGGER `tg_campanhas_clientes_alt` BEFORE UPDATE ON `campanhas_clientes` FOR EACH ROW &#013;&#010;BEGIN  &#013;&#010;  IF (NEW.CONCLUIDO = &quot;NAO&quot;) THEN   &#013;&#010;    SET NEW.OPERADOR_LIGACAO = 0;  &#013;&#010;  END IF; &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; NEW.OPERADOR_LIGACAO AND NEW.CONCLUIDO = &quot;SIM&quot; AND NEW.OPERADOR &gt; 0 AND&#013;&#010;   exists(SELECT CODIGO FROM propostas  WHERE LIGACAO = NEW.CODIGO LIMIT 1) THEN&#013;&#010;    SET NEW.OPERADOR_LIGACAO = NEW.OPERADOR; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF NEW.AGENDA = -1 THEN&#013;&#010;    SET NEW.AGENDA = 0;&#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  #SET @OPERADOR_CLIENTE = 0;     &#013;&#010;  #SELECT OPERADOR FROM clientes WHERE CODIGO = NEW.CLIENTE INTO @OPERADOR_CLIENTE;&#013;&#010;  &#013;&#010;  #IF NEW.CONCLUIDO = &quot;NAO&quot; AND NEW.OPERADOR &lt;&gt; 0 AND NEW.OPERADOR &lt;&gt; @OPERADOR_CLIENTE AND @OPERADOR_CLIENTE &lt;&gt; -2 THEN&#013;&#010;  #   SET NEW.OPERADOR = @OPERADOR_CLIENTE;&#013;&#010;  #END IF;   &#013;&#010;END;"/><ROW RowState="13" CODIGO="228" DATA="20161006" SQL="CREATE TRIGGER `tg_campanhas_clientes_new` BEFORE INSERT ON `campanhas_clientes` FOR EACH ROW &#013;&#010;BEGIN  &#013;&#010;  IF (NEW.CONCLUIDO = &quot;NAO&quot;) THEN   &#013;&#010;    SET NEW.OPERADOR_LIGACAO = 0;  &#013;&#010;  END IF; &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; NEW.OPERADOR_LIGACAO AND NEW.CONCLUIDO = &quot;SIM&quot; AND NEW.OPERADOR &gt; 0 AND&#013;&#010;   exists(SELECT CODIGO FROM propostas  WHERE LIGACAO = NEW.CODIGO LIMIT 1) THEN&#013;&#010;    SET NEW.OPERADOR_LIGACAO = NEW.OPERADOR; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF NEW.AGENDA = -1 THEN&#013;&#010;    SET NEW.AGENDA = 0;&#013;&#010;  END IF;  &#013;&#010;&#013;&#010;  #SET @OPERADOR_CLIENTE = 0;     &#013;&#010;  #SELECT OPERADOR FROM clientes WHERE CODIGO = NEW.CLIENTE INTO @OPERADOR_CLIENTE;&#013;&#010;  &#013;&#010;  #IF NEW.CONCLUIDO = &quot;NAO&quot; AND NEW.OPERADOR &lt;&gt; 0 AND NEW.OPERADOR &lt;&gt; @OPERADOR_CLIENTE AND @OPERADOR_CLIENTE &lt;&gt; -2 THEN&#013;&#010;  #   SET NEW.OPERADOR = @OPERADOR_CLIENTE;&#013;&#010;  #END IF;&#013;&#010;END;"/><ROW RowState="13" CODIGO="229" DATA="20161006" SQL="CREATE TRIGGER `tg_clientes_add` BEFORE INSERT ON `clientes` FOR EACH ROW BEGIN&#013;&#010;  IF LENGTH(CONCAT(NEW.AREA1,NEW.FONE1)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA1,NEW.FONE1),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA2,NEW.FONE2)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA2,NEW.FONE2),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA3,NEW.FONE3)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA3,NEW.FONE3),&quot;Cliente&quot;);&#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN &#013;&#010;    SET NEW.COD_ERP = NULL; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;END;"/><ROW RowState="13" CODIGO="230" DATA="20161006" SQL="CREATE TRIGGER `tg_clientes_alt` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN  &#013;&#010;  IF (NEW.COD_ERP = &quot;&quot;) THEN   &#013;&#010;    SET NEW.COD_ERP = null;  &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA1,NEW.FONE1)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA1,NEW.FONE1),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA2,NEW.FONE2)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA2,NEW.FONE2),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA3,NEW.FONE3)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA3,NEW.FONE3),&quot;Cliente&quot;);&#013;&#010;  END IF;&#013;&#010;  &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;&#013;&#010;  &#013;&#010;END;"/><ROW RowState="13" CODIGO="230" DATA="20161006" SQL="CREATE TRIGGER `tg_clientes_alt` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN  &#013;&#010;  IF (NEW.COD_ERP = &quot;&quot;) THEN   &#013;&#010;    SET NEW.COD_ERP = null;  &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA1,NEW.FONE1)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA1,NEW.FONE1),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA2,NEW.FONE2)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA2,NEW.FONE2),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA3,NEW.FONE3)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA3,NEW.FONE3),&quot;Cliente&quot;);&#013;&#010;  END IF;&#013;&#010;  &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;&#013;&#010;  &#013;&#010;END;"/><ROW RowState="12" CODIGO="221" DATA="20161006" SQL="DROP TRIGGER IF EXISTS BU_ERP_NULL_ALTERACOES;"/><ROW RowState="13" CODIGO="229" DATA="20161006" SQL="CREATE TRIGGER `tg_clientes_add` BEFORE INSERT ON `clientes` FOR EACH ROW BEGIN&#013;&#010;  IF LENGTH(CONCAT(NEW.AREA1,NEW.FONE1)) &gt;= 10 THEN&#013;&#010;    DELETE FROM fones_campanha_cli where CLIENTE = NEW.CODIGO AND FONE = CONCAT(NEW.AREA1,NEW.FONE1); &#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA1,NEW.FONE1),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA2,NEW.FONE2)) &gt;= 10 THEN&#013;&#010;    DELETE FROM fones_campanha_cli where CLIENTE = NEW.CODIGO AND FONE = CONCAT(NEW.AREA2,NEW.FONE2);   &#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA2,NEW.FONE2),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA3,NEW.FONE3)) &gt;= 10 THEN&#013;&#010;    DELETE FROM fones_campanha_cli where CLIENTE = NEW.CODIGO AND FONE = CONCAT(NEW.AREA3,NEW.FONE3); &#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA3,NEW.FONE3),&quot;Cliente&quot;);&#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN &#013;&#010;    SET NEW.COD_ERP = NULL; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;END;"/><ROW RowState="4" CODIGO="238" DATA="20161026" SQL="ALTER TABLE `parametros`  ADD COLUMN `VERSAO_SISTEMA` VARCHAR(20) NULL;"/><ROW RowState="4" CODIGO="239" DATA="20161026" SQL="ALTER TABLE `alteracoes_clientes`  DROP FOREIGN KEY `FK_ALTERA_CLI_CLIENTE`;"/><ROW RowState="13" CODIGO="227" DATA="20161006" SQL="CREATE TRIGGER `tg_campanhas_clientes_alt` BEFORE UPDATE ON `campanhas_clientes` FOR EACH ROW &#013;&#010;BEGIN  &#013;&#010;  IF (NEW.CONCLUIDO = &quot;NAO&quot;) THEN   &#013;&#010;    SET NEW.OPERADOR_LIGACAO = 0;  &#013;&#010;  END IF; &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; NEW.OPERADOR_LIGACAO AND NEW.CONCLUIDO = &quot;SIM&quot; AND NEW.OPERADOR &gt; 0 AND&#013;&#010;   exists(SELECT CODIGO FROM propostas  WHERE LIGACAO = NEW.CODIGO LIMIT 1) THEN&#013;&#010;    SET NEW.OPERADOR_LIGACAO = NEW.OPERADOR; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF NEW.AGENDA = -1 THEN&#013;&#010;    SET NEW.AGENDA = 0;&#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  #SET @OPERADOR_CLIENTE = 0;     &#013;&#010;  #SELECT OPERADOR FROM clientes WHERE CODIGO = NEW.CLIENTE INTO @OPERADOR_CLIENTE;&#013;&#010;  &#013;&#010;  #IF NEW.CONCLUIDO = &quot;NAO&quot; AND NEW.OPERADOR &lt;&gt; 0 AND NEW.OPERADOR &lt;&gt; @OPERADOR_CLIENTE AND @OPERADOR_CLIENTE &lt;&gt; -2 THEN&#013;&#010;  #   SET NEW.OPERADOR = @OPERADOR_CLIENTE;&#013;&#010;  #END IF;   &#013;&#010;END;"/><ROW RowState="13" CODIGO="228" DATA="20161006" SQL="CREATE TRIGGER `tg_campanhas_clientes_new` BEFORE INSERT ON `campanhas_clientes` FOR EACH ROW &#013;&#010;BEGIN  &#013;&#010;  IF (NEW.CONCLUIDO = &quot;NAO&quot;) THEN   &#013;&#010;    SET NEW.OPERADOR_LIGACAO = 0;  &#013;&#010;  END IF; &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; NEW.OPERADOR_LIGACAO AND NEW.CONCLUIDO = &quot;SIM&quot; AND NEW.OPERADOR &gt; 0 AND&#013;&#010;   exists(SELECT CODIGO FROM propostas  WHERE LIGACAO = NEW.CODIGO LIMIT 1) THEN&#013;&#010;    SET NEW.OPERADOR_LIGACAO = NEW.OPERADOR; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF NEW.AGENDA = -1 THEN&#013;&#010;    SET NEW.AGENDA = 0;&#013;&#010;  END IF;  &#013;&#010;&#013;&#010;  #SET @OPERADOR_CLIENTE = 0;     &#013;&#010;  #SELECT OPERADOR FROM clientes WHERE CODIGO = NEW.CLIENTE INTO @OPERADOR_CLIENTE;&#013;&#010;  &#013;&#010;  #IF NEW.CONCLUIDO = &quot;NAO&quot; AND NEW.OPERADOR &lt;&gt; 0 AND NEW.OPERADOR &lt;&gt; @OPERADOR_CLIENTE AND @OPERADOR_CLIENTE &lt;&gt; -2 THEN&#013;&#010;  #   SET NEW.OPERADOR = @OPERADOR_CLIENTE;&#013;&#010;  #END IF;&#013;&#010;END;"/><ROW RowState="13" CODIGO="229" DATA="20161006" SQL="CREATE TRIGGER `tg_clientes_add` BEFORE INSERT ON `clientes` FOR EACH ROW BEGIN&#013;&#010;  IF LENGTH(CONCAT(NEW.AREA1,NEW.FONE1)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA1,NEW.FONE1),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA2,NEW.FONE2)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA2,NEW.FONE2),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA3,NEW.FONE3)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA3,NEW.FONE3),&quot;Cliente&quot;);&#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN &#013;&#010;    SET NEW.COD_ERP = NULL; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;  SET @contador = 0; &#013;&#010;  &#013;&#010;  SELECT MIN(CODIGO) FROM (SELECT (CODIGO) FROM&#013;&#010;     fones_campanha_cli WHERE CLIENTE = NEW.CODIGO order by CODIGO desc limit 3)&#009;A&#013;&#010;  INTO @contador;&#013;&#010;     &#013;&#010;  if (@contador &gt; 0) then&#013;&#010;    delete from fones_campanha_cli WHERE CLIENTE = NEW.CODIGO and CODIGO &lt; @contador;&#013;&#010;  END IF;&#013;&#010;&#013;&#010;END;"/><ROW RowState="13" CODIGO="230" DATA="20161006" SQL="CREATE TRIGGER `tg_clientes_alt` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN  &#013;&#010;  IF (NEW.COD_ERP = &quot;&quot;) THEN   &#013;&#010;    SET NEW.COD_ERP = null;  &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA1,NEW.FONE1)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA1,NEW.FONE1),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA2,NEW.FONE2)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA2,NEW.FONE2),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA3,NEW.FONE3)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA3,NEW.FONE3),&quot;Cliente&quot;);&#013;&#010;  END IF;&#013;&#010;  &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;&#013;&#010;&#013;&#010;  SET @contador = 0; &#013;&#010;  &#013;&#010;  SELECT MIN(CODIGO) FROM (SELECT (CODIGO) FROM&#013;&#010;     fones_campanha_cli WHERE CLIENTE = NEW.CODIGO order by CODIGO desc limit 3)&#009;A&#013;&#010;  INTO @contador;&#013;&#010;     &#013;&#010;  if (@contador &gt; 0) then&#013;&#010;    delete from fones_campanha_cli WHERE CLIENTE = NEW.CODIGO and CODIGO &lt; @contador;&#013;&#010;  END IF;&#013;&#010;  &#013;&#010;END;"/><ROW RowState="4" CODIGO="240" DATA="20161111" SQL="DROP TABLE IF EXISTS `parametro_ocultar_ag_operador`;&#013;&#010;"/><ROW RowState="4" CODIGO="241" DATA="20161111" SQL="CREATE TABLE IF NOT EXISTS `parametro_ocultar_ag_operador` (&#013;&#010;  `OPERADOR` int(10) NOT NULL,&#013;&#010;  PRIMARY KEY (`OPERADOR`),&#013;&#010;  CONSTRAINT `FK__PARAMETRO_OCULTAR_AG_OPERADOR` FOREIGN KEY (`OPERADOR`) REFERENCES `operadores` (`CODIGO`) ON DELETE CASCADE ON UPDATE CASCADE&#013;&#010;);"/><ROW RowState="12" CODIGO="227" DATA="20161006" SQL="CREATE TRIGGER `tg_campanhas_clientes_alt` BEFORE UPDATE ON `campanhas_clientes` FOR EACH ROW &#013;&#010;BEGIN  &#013;&#010;  IF (NEW.CONCLUIDO = &quot;NAO&quot;) THEN   &#013;&#010;    SET NEW.OPERADOR_LIGACAO = 0;  &#013;&#010;  END IF; &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; NEW.OPERADOR_LIGACAO AND NEW.CONCLUIDO = &quot;SIM&quot; AND NEW.OPERADOR &gt; 0 AND&#013;&#010;   exists(SELECT CODIGO FROM propostas  WHERE LIGACAO = NEW.CODIGO LIMIT 1) THEN&#013;&#010;    SET NEW.OPERADOR_LIGACAO = NEW.OPERADOR; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF NEW.AGENDA = -1 THEN&#013;&#010;    SET NEW.AGENDA = 0;&#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  #SET @OPERADOR_CLIENTE = 0;     &#013;&#010;  #SELECT OPERADOR FROM clientes WHERE CODIGO = NEW.CLIENTE INTO @OPERADOR_CLIENTE;&#013;&#010;  &#013;&#010;  #IF NEW.CONCLUIDO = &quot;NAO&quot; AND NEW.OPERADOR &lt;&gt; 0 AND NEW.OPERADOR &lt;&gt; @OPERADOR_CLIENTE AND @OPERADOR_CLIENTE &lt;&gt; -2 THEN&#013;&#010;  #   SET NEW.OPERADOR = @OPERADOR_CLIENTE;&#013;&#010;  #END IF;   &#013;&#010;END;"/><ROW RowState="12" CODIGO="228" DATA="20161006" SQL="CREATE TRIGGER `tg_campanhas_clientes_new` BEFORE INSERT ON `campanhas_clientes` FOR EACH ROW &#013;&#010;BEGIN  &#013;&#010;  IF (NEW.CONCLUIDO = &quot;NAO&quot;) THEN   &#013;&#010;    SET NEW.OPERADOR_LIGACAO = 0;  &#013;&#010;  END IF; &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; NEW.OPERADOR_LIGACAO AND NEW.CONCLUIDO = &quot;SIM&quot; AND NEW.OPERADOR &gt; 0 AND&#013;&#010;   exists(SELECT CODIGO FROM propostas  WHERE LIGACAO = NEW.CODIGO LIMIT 1) THEN&#013;&#010;    SET NEW.OPERADOR_LIGACAO = NEW.OPERADOR; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF NEW.AGENDA = -1 THEN&#013;&#010;    SET NEW.AGENDA = 0;&#013;&#010;  END IF;  &#013;&#010;&#013;&#010;  #SET @OPERADOR_CLIENTE = 0;     &#013;&#010;  #SELECT OPERADOR FROM clientes WHERE CODIGO = NEW.CLIENTE INTO @OPERADOR_CLIENTE;&#013;&#010;  &#013;&#010;  #IF NEW.CONCLUIDO = &quot;NAO&quot; AND NEW.OPERADOR &lt;&gt; 0 AND NEW.OPERADOR &lt;&gt; @OPERADOR_CLIENTE AND @OPERADOR_CLIENTE &lt;&gt; -2 THEN&#013;&#010;  #   SET NEW.OPERADOR = @OPERADOR_CLIENTE;&#013;&#010;  #END IF;&#013;&#010;END;"/><ROW RowState="12" CODIGO="229" DATA="20161006" SQL="CREATE TRIGGER `tg_clientes_add` BEFORE INSERT ON `clientes` FOR EACH ROW BEGIN&#013;&#010;  IF LENGTH(CONCAT(NEW.AREA1,NEW.FONE1)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA1,NEW.FONE1),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA2,NEW.FONE2)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA2,NEW.FONE2),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA3,NEW.FONE3)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA3,NEW.FONE3),&quot;Cliente&quot;);&#013;&#010;  END IF;&#013;&#010;&#013;&#010;  IF TRIM(NEW.COD_ERP) = &quot;&quot; THEN &#013;&#010;    SET NEW.COD_ERP = NULL; &#013;&#010;  END IF;&#013;&#010;&#013;&#010;  SET @contador = 0; &#013;&#010;  &#013;&#010;  SELECT MIN(CODIGO) FROM (SELECT (CODIGO) FROM&#013;&#010;     fones_campanha_cli WHERE CLIENTE = NEW.CODIGO order by CODIGO desc limit 3)&#009;A&#013;&#010;  INTO @contador;&#013;&#010;     &#013;&#010;  if (@contador &gt; 0) then&#013;&#010;    delete from fones_campanha_cli WHERE CLIENTE = NEW.CODIGO and CODIGO &lt; @contador;&#013;&#010;  END IF;&#013;&#010;&#013;&#010;END;"/><ROW RowState="12" CODIGO="230" DATA="20161006" SQL="CREATE TRIGGER `tg_clientes_alt` BEFORE UPDATE ON `clientes` FOR EACH ROW BEGIN  &#013;&#010;  IF (NEW.COD_ERP = &quot;&quot;) THEN   &#013;&#010;    SET NEW.COD_ERP = null;  &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA1,NEW.FONE1)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA1,NEW.FONE1),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA2,NEW.FONE2)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA2,NEW.FONE2),&quot;Cliente&quot;);&#013;&#010;  END IF; &#013;&#010;  &#013;&#010;  IF LENGTH(CONCAT(NEW.AREA3,NEW.FONE3)) &gt;= 10 THEN&#013;&#010;    INSERT IGNORE INTO fones_campanha_cli (CLIENTE,FONE,TIPO_CONTATO)&#013;&#010;&#009; VALUES(NEW.CODIGO,CONCAT(NEW.AREA3,NEW.FONE3),&quot;Cliente&quot;);&#013;&#010;  END IF;&#013;&#010;  &#013;&#010;  IF NEW.ATUALIZADOR = &quot;CADASTRO&quot; THEN                                                                                                                                                                 &#013;&#010;  IF NEW.RAZAO &lt;&gt; OLD.RAZAO THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`) &#013;&#010;    VALUES (NULL, NOW(), &quot;RAZAO&quot;,NEW.RAZAO ,OLD.RAZAO , NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);&#013;&#010;  END IF;     &#013;&#010;                                                                                                                                                                                        &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.FANTASIA &lt;&gt; OLD.FANTASIA THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;FANTASIA&quot;,NEW.FANTASIA ,OLD.FANTASIA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.ATIVO &lt;&gt; OLD.ATIVO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATIVO&quot;,NEW.ATIVO ,OLD.ATIVO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                             &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CPF_CNPJ &lt;&gt; OLD.CPF_CNPJ THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CNPJ&quot;,NEW.CPF_CNPJ ,OLD.CPF_CNPJ ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                 &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.IE_RG &lt;&gt; OLD.IE_RG THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;INSCRIÇÃO ESTADUAL&quot;,NEW.IE_RG ,OLD.IE_RG ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                         &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.END_RUA &lt;&gt; OLD.END_RUA THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ENDEREÇO&quot;,NEW.END_RUA ,OLD.END_RUA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;  &#013;&#010;  IF NEW.GRUPO &lt;&gt; OLD.GRUPO THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;GRUPO&quot;,NEW.GRUPO ,OLD.GRUPO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                               &#013;&#010;  END IF;&#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CIDADE &lt;&gt; OLD.CIDADE THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CIDADE&quot;,NEW.CIDADE ,OLD.CIDADE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.BAIRRO &lt;&gt; OLD.BAIRRO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;BAIRRO&quot;,NEW.BAIRRO ,OLD.BAIRRO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.ESTADO &lt;&gt; OLD.ESTADO THEN                                                                                                                                                                   &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ESTADO&quot;,NEW.ESTADO ,OLD.ESTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CEP &lt;&gt; OLD.CEP THEN                                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CEP&quot;,NEW.CEP ,OLD.CEP ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                            &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.COMPLEMENTO &lt;&gt; OLD.COMPLEMENTO THEN                                                                                                                                                         &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COMPLEMENTO&quot;,NEW.COMPLEMENTO ,OLD.COMPLEMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                    &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA1 &lt;&gt; OLD.AREA1) OR (NEW.FONE1 &lt;&gt; OLD.FONE1) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 1&quot;,CONCAT(NEW.AREA1,NEW.FONE1) ,CONCAT(OLD.AREA1,OLD.FONE1) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA2 &lt;&gt; OLD.AREA2) OR (NEW.FONE2 &lt;&gt; OLD.FONE2) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 2&quot;,CONCAT(NEW.AREA2,NEW.FONE2) ,CONCAT(OLD.AREA2,OLD.FONE2) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF (NEW.AREA3 &lt;&gt; OLD.AREA3) OR (NEW.FONE3 &lt;&gt; OLD.FONE3) THEN                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;TELEFONE 3&quot;,CONCAT(NEW.AREA3,NEW.FONE3) ,CONCAT(OLD.AREA3,OLD.FONE3) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                             &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;         &#013;&#010;  IF NEW.DESC_FONE1 &lt;&gt; OLD.DESC_FONE1 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE1&quot;,NEW.DESC_FONE1 ,OLD.DESC_FONE1 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;&#013;&#010;  IF NEW.DESC_FONE2 &lt;&gt; OLD.DESC_FONE2 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE2&quot;,NEW.DESC_FONE2 ,OLD.DESC_FONE2 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.DESC_FONE3 &lt;&gt; OLD.DESC_FONE3 THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DESC_FONE3&quot;,NEW.DESC_FONE3 ,OLD.DESC_FONE3 ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#009;&#009;&#009;                                                                                                                                                                                            &#013;&#010;  IF NEW.EMAIL &lt;&gt; OLD.EMAIL THEN                                                                                                                                                                     &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;EMAIL&quot;,NEW.EMAIL ,OLD.EMAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.WEBSITE &lt;&gt; OLD.WEBSITE THEN                                                                                                                                                                 &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SITE&quot;,NEW.WEBSITE ,OLD.WEBSITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                                                   &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_ADMIN &lt;&gt; OLD.OBS_ADMIN THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_ADMIN&quot;,NEW.OBS_ADMIN ,OLD.OBS_ADMIN ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;&#013;&#010;  IF NEW.OBS_OPERADOR &lt;&gt; OLD.OBS_OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OBS_OPERADOR&quot;,NEW.OBS_OPERADOR ,OLD.OBS_OPERADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;  IF NEW.ORIGEM &lt;&gt; OLD.ORIGEM THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ORIGEM&quot;,NEW.ORIGEM ,OLD.ORIGEM ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                               &#013;&#010;&#013;&#010;  IF NEW.OPERADOR &lt;&gt; OLD.OPERADOR THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;OPERADOR DO CLIENTE&quot;,(SELECT NOME FROM operadores WHERE CODIGO =  NEW.OPERADOR) ,(SELECT NOME FROM operadores WHERE CODIGO =  OLD.OPERADOR) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);      &#013;&#010;  END IF;                                                                                                                                                                                                                                                                                                                                                                                                 &#013;&#010;&#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                               &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,(SELECT NOME FROM segmentos WHERE CODIGO = NEW.SEGMENTO) ,(SELECT NOME FROM segmentos WHERE CODIGO = OLD.SEGMENTO) ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                     &#013;&#010;  END IF;                                                                                                                                                                                            &#013;&#010;                                                                                                                                                                                                     &#013;&#010;  IF NEW.CONTATO_MAIL &lt;&gt; OLD.CONTATO_MAIL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;CONTATO DO EMAIL&quot;,NEW.CONTATO_MAIL ,OLD.CONTATO_MAIL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;&#013;&#010;  IF NEW.SALDO_DISPONIVEL &lt;&gt; OLD.SALDO_DISPONIVEL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_DISPONIVEL&quot;,NEW.SALDO_DISPONIVEL ,OLD.SALDO_DISPONIVEL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SALDO_LIMITE &lt;&gt; OLD.SALDO_LIMITE THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SALDO_LIMITE&quot;,NEW.SALDO_LIMITE ,OLD.SALDO_LIMITE ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;   &#013;&#010;  &#013;&#010;  IF NEW.POTENCIAL &lt;&gt; OLD.POTENCIAL THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;POTENCIAL&quot;,NEW.POTENCIAL ,OLD.POTENCIAL ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.DATA_ULT_COMPRA &lt;&gt; OLD.DATA_ULT_COMPRA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DATA_ULT_COMPRA&quot;,NEW.DATA_ULT_COMPRA ,OLD.DATA_ULT_COMPRA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;  &#013;&#010;  IF NEW.SEGMENTO &lt;&gt; OLD.SEGMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;SEGMENTO&quot;,NEW.SEGMENTO ,OLD.SEGMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;  &#013;&#010;  IF NEW.ULTI_RESULTADO &lt;&gt; OLD.ULTI_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ULTI_RESULTADO&quot;,NEW.ULTI_RESULTADO ,OLD.ULTI_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.DT_AGENDAMENTO &lt;&gt; OLD.DT_AGENDAMENTO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;DT_AGENDAMENTO&quot;,NEW.DT_AGENDAMENTO ,OLD.DT_AGENDAMENTO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;     &#013;&#010;&#013;&#010;  IF NEW.COD_CAMPANHA &lt;&gt; OLD.COD_CAMPANHA THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_CAMPANHA&quot;,NEW.COD_CAMPANHA ,OLD.COD_CAMPANHA ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;  &#013;&#010;  &#013;&#010;&#013;&#010;  IF NEW.COD_RESULTADO &lt;&gt; OLD.COD_RESULTADO THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;COD_RESULTADO&quot;,NEW.COD_RESULTADO ,OLD.COD_RESULTADO ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF;    &#013;&#010;             &#013;&#010;  IF NEW.ATUALIZADOR &lt;&gt; OLD.ATUALIZADOR THEN                                                                                                                                                       &#013;&#010;    INSERT INTO alteracoes_clientes (`CODIGO`,`DATAHORA`,`CAMPO`,`VALOR_NOVO`,`VALOR_ANTIGO`,`CODIGO_SGR`,`CODIGO_ERP`, `OPERADOR_LOGIN`)                                                                              &#013;&#010;    VALUES(NULL, NOW(), &quot;ATUALIZADOR&quot;,NEW.ATUALIZADOR ,OLD.ATUALIZADOR ,NEW.CODIGO, NEW.COD_ERP, NEW.OPERADOR_LOGIN);                                                                                             &#013;&#010;  END IF; &#009;&#009;&#009;&#009; &#013;&#010;&#009;&#009;&#009;&#009;                                                                                                                                                                              &#013;&#010;END IF;                                                                                                                                                                                              &#013;&#010; SET NEW.ATUALIZADOR = &quot;ATUALIZAÇÃO&quot;;      &#013;&#010;IF NEW.DATA_ULT_COMPRA &lt; OLD.DATA_ULT_COMPRA THEN&#013;&#010;   SET NEW.DATA_ULT_COMPRA = OLD.DATA_ULT_COMPRA;&#013;&#010;  END IF;&#013;&#010;&#013;&#010;  SET @contador = 0; &#013;&#010;  &#013;&#010;  SELECT MIN(CODIGO) FROM (SELECT (CODIGO) FROM&#013;&#010;     fones_campanha_cli WHERE CLIENTE = NEW.CODIGO order by CODIGO desc limit 3)&#009;A&#013;&#010;  INTO @contador;&#013;&#010;     &#013;&#010;  if (@contador &gt; 0) then&#013;&#010;    delete from fones_campanha_cli WHERE CLIENTE = NEW.CODIGO and CODIGO &lt; @contador;&#013;&#010;  END IF;&#013;&#010;  &#013;&#010;END;"/><ROW RowState="4" CODIGO="242" DATA="20170102" SQL="ALTER TABLE parametros add ATIVO_ALTERAR_RAZAO CHAR(1);"/><ROW RowState="4" CODIGO="243" DATA="20170102" SQL="ALTER TABLE resultados add EPEDIDO ENUM(&apos;SIM&apos;,&apos;NAO&apos;);"/><ROW RowState="5" CODIGO="244" DATA="20170102" SQL="ALTER TABLE parametros add ATIVO_ALTERAR_RAZAO CHAR(1);"/><ROW RowState="5" CODIGO="245" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTES` ENUM(&apos;SIM&apos;,&apos;NAO&apos;) NULL DEFAULT &apos;SIM&apos; AFTER `EPEDIDO`;"/><ROW RowState="5" CODIGO="246" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_COMPRAS` ENUM(&apos;SIM&apos;,&apos;NAO&apos;) NULL DEFAULT &apos;SIM&apos; AFTER `IMPORTAR_CLIENTES`;"/><ROW RowState="5" CODIGO="247" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTE_EXISTENTE` ENUM(&apos;SIM&apos;,&apos;NAO&apos;) NULL DEFAULT &apos;SIM&apos; AFTER `IMPORTAR_COMPRAS`;"/><ROW RowState="13" CODIGO="245" DATA="20170109" SQL="ALTER TABLE resultados add EPEDIDO ENUM(&apos;SIM&apos;,&apos;NAO&apos;);&#013;&#010;"/><ROW RowState="13" CODIGO="246" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTES` ENUM(&apos;SIM&apos;,&apos;NAO&apos;) NULL DEFAULT &apos;SIM&apos; AFTER `EPEDIDO`;&#013;&#010;"/><ROW RowState="13" CODIGO="247" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_COMPRAS` ENUM(&apos;SIM&apos;,&apos;NAO&apos;) NULL DEFAULT &apos;SIM&apos; AFTER `IMPORTAR_CLIENTES`;&#013;&#010;"/><ROW RowState="5" CODIGO="248" DATA="20170111" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTE_EXISTENTE` ENUM(&apos;SIM&apos;,&apos;NAO&apos;) NULL DEFAULT &apos;SIM&apos; AFTER `IMPORTAR_COMPRAS`;"/><ROW RowState="13" CODIGO="246" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_COMPRAS` ENUM(&apos;SIM&apos;,&apos;NAO&apos;) NULL DEFAULT &apos;SIM&apos; AFTER `IMPORTAR_CLIENTES`;"/><ROW RowState="13" CODIGO="246" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTES` ENUM(&apos;SIM&apos;,&apos;NAO&apos;) NULL DEFAULT &apos;SIM&apos; AFTER `EPEDIDO`;"/><ROW RowState="14" CODIGO="245" DATA="20170109" SQL="&#013;&#010;"/><ROW RowState="13" CODIGO="246" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTES` ENUM(&apos;SIM&apos;,&apos;NAO&apos;) NULL DEFAULT &apos;SIM&apos;;"/><ROW RowState="4" CODIGO="249" DATA="20170119" SQL="alter table `parametros` add column IMP_POR_CPFNCPJ_CLIENTE char(1) DEFAULT &apos;N&apos;;"/><ROW RowState="13" CODIGO="246" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTES` CHAR(1) NULL DEFAULT &apos;S&apos; AFTER `EPEDIDO`;&#013;&#010;ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_COMPRAS` CHAR(1) NULL DEFAULT &apos;S&apos; AFTER `IMPORTAR_CLIENTES`;&#013;&#010;ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTE_EXISTENTE` CHAR(1) NULL DEFAULT &apos;S&apos; AFTER `IMPORTAR_COMPRAS`;&#013;&#010;"/><ROW RowState="13" CODIGO="246" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTES` CHAR(1) NULL DEFAULT &apos;S&apos; AFTER `EPEDIDO`;&#013;&#010;&#013;&#010;"/><ROW RowState="13" CODIGO="247" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_COMPRAS` CHAR(1) NULL DEFAULT &apos;S&apos; AFTER `IMPORTAR_CLIENTES`;&#013;&#010;&#013;&#010;"/><ROW RowState="13" CODIGO="248" DATA="20170111" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTE_EXISTENTE` CHAR(1) NULL DEFAULT &apos;S&apos; AFTER `IMPORTAR_COMPRAS`;"/><ROW RowState="12" CODIGO="246" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTES` CHAR(1) NULL DEFAULT &apos;S&apos; AFTER `ATIVO_ALTERAR_RAZAO`;&#013;&#010;"/><ROW RowState="12" CODIGO="247" DATA="20170109" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_COMPRAS` CHAR(1) NULL DEFAULT &apos;S&apos; AFTER `IMPORTAR_CLIENTES`;&#013;&#010;&#013;&#010;&#013;&#010;"/><ROW RowState="12" CODIGO="248" DATA="20170111" SQL="ALTER TABLE `parametros`  ADD COLUMN `IMPORTAR_CLIENTE_EXISTENTE` CHAR(1) NULL DEFAULT &apos;S&apos; AFTER `IMPORTAR_COMPRAS`;"/><ROW RowState="5" CODIGO="250" DATA="20170216" SQL="ALTER TABLE `historico_cli` DROP FOREIGN KEY `FK_HISTO_CLI_CLIENTE`;&#013;&#010;ALTER TABLE `historico_cli`  ADD CONSTRAINT `FK_HISTO_CLI_CLIENTE` FOREIGN KEY (`CLIENTE`) REFERENCES `clientes` (`CODIGO`) ON UPDATE CASCADE ON DELETE CASCADE;"/><ROW RowState="4" CODIGO="251" DATA="20170216" SQL="CREATE TABLE operadores_ligacoes (&#013;&#010; `CODIGO` INT(11) NOT NULL AUTO_INCREMENT,&#013;&#010; `OPERADOR` INT(11) NOT NULL,&#013;&#010; `INICIO` TIMESTAMP NOT NULL DEFAULT NOW(),&#013;&#010; `FIM` TIMESTAMP NULL,&#013;&#010; PRIMARY KEY (`CODIGO`)&#013;&#010;)&#013;&#010;COLLATE=&apos;latin1_swedish_ci&apos;&#013;&#010;ENGINE=InnoDB&#013;&#010;ROW_FORMAT=DEFAULT"/><ROW RowState="5" CODIGO="252" DATA="20170223" SQL="ALTER TABLE `clientes` ADD COLUMN `OBS_FONE1` VARCHAR(255) NULL DEFAULT NULL AFTER `OPERADOR_LOGIN`,  ADD COLUMN `OBS_FONE2` VARCHAR(255) NULL DEFAULT NULL AFTER `OBS_FONE1`,  ADD COLUMN `OBS_FONE3` VARCHAR(255) NULL DEFAULT NULL AFTER `OBS_FONE2`;&#013;&#010;"/><ROW RowState="6" CODIGO="253" DATA="20170223" SQL="ALTER TABLE parametros ADD CARTEIRA_FIXA_OPERADOR CHAR(1);"/><ROW RowState="6" CODIGO="254" DATA="20170223" SQL="ALTER TABLE parametros ADD TEMPO_MINIMO_CONVERSA INTEGER;"/><ROW RowState="6" CODIGO="255" DATA="20170223" SQL="DROP PROCEDURE `PR_ATUALIZA_DT_ULT_COMPRA_CLI;"/><ROW RowState="5" CODIGO="256" DATA="20170223" SQL="CREATE DEFINER=`root`@`localhost` PROCEDURE `PR_ATUALIZA_DT_ULT_COMPRA_CLI`()&#013;&#010;BEGIN&#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;INNER JOIN&#013;&#010;&#009;campanhas_clientes CC ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;INNER JOIN&#013;&#010;&#009;resultados R ON (R.CODIGO = CC.RESULTADO)&#013;&#010;SET&#013;&#010;&#009;CC.OPERADOR = 0,&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &lt;&gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2)&#013;&#010;&#009;AND R.COD_ACAO &lt;&gt; 8&#013;&#010;&#009;AND (CLI.DATA_ULT_COMPRA &lt; DATE_SUB(NOW(), INTERVAL (SELECT INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY)&#013;&#010;&#009;&#009;  OR CLI.DATA_ULT_COMPRA IS NULL)&#013;&#010;        AND (SELECT COALESCE(CARTEIRA_FIXA_OPERADOR,&apos;N&apos;) FROM parametros) &lt;&gt; &apos;S&apos;;&#013;&#010;           &#013;&#010;UPDATE clientes SET OPERADOR = 0 WHERE DATA_ULT_COMPRA IS NULL;&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;campanhas_clientes CC&#013;&#010;&#009;INNER JOIN clientes CLI ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;SET&#013;&#010;&#009;CC.CAMPANHA = @CC := IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND NOW(),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_ANTIGOS&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND DATE_SUB(NOW(), INTERVAL (&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)+1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)-1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE)))),&#013;&#010; &#009;CLI.COD_CAMPANHA = @CC&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2);&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;SET&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.DATA_ULT_COMPRA &lt;= DATE_SUB(NOW(), INTERVAL (SELECT U.INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY)&#013;&#010;AND CLI.OPERADOR &lt;&gt; -2;&#013;&#010;END//"/><ROW RowState="6" CODIGO="257" DATA="20170223" SQL="CREATE TABLE TRANSFERENCIA_CLIENTES&#013;&#010;(&#013;&#010;  CODIGO INTEGER NOT NULL AUTO_INCREMENT,&#013;&#010;  DATA_HORA TIMESTAMP NOT NULL DEFAULT NOW(),&#013;&#010;  OPERADOR INTEGER NOT NULL,&#013;&#010;  OPERADOR_ORIGEM INTEGER NOT NULL,  &#013;&#010;  OPERADOR_DESTINO INTEGER NOT NULL,&#013;&#010;  PRIMARY KEY(CODIGO) &#013;&#010;);"/><ROW RowState="6" CODIGO="258" DATA="20170223" SQL="CREATE TABLE TRANSFERENCIA_CLIENTES_ITENS&#013;&#010;(&#013;&#010;  CODIGO INTEGER NOT NULL,&#013;&#010;  CLIENTE INTEGER NOT NULL,&#013;&#010;  PRIMARY KEY(CODIGO, CLIENTE),&#013;&#010;  CONSTRAINT FK_TRANSFERENCIA_CLIENTES_ITENS FOREIGN KEY(CODIGO) &#013;&#010;  REFERENCES TRANSFERENCIA_CLIENTES(CODIGO) ON DELETE CASCADE ON UPDATE CASCADE  &#013;&#010;);"/><ROW RowState="5" CODIGO="259" DATA="20170223" SQL="CREATE TRIGGER `tg_transferencia_clientes_del` BEFORE DELETE ON `transferencia_clientes` FOR EACH ROW BEGIN&#013;&#010;  update clientes set OPERADOR = old.OPERADOR_ORIGEM &#013;&#010;  where CODIGO in (select CLIENTE from transferencia_clientes_itens where CODIGO = old.CODIGO);&#013;&#010;END"/><ROW RowState="6" CODIGO="260" DATA="20170223" SQL="CREATE TRIGGER `tg_transferencia_cli_del` BEFORE DELETE ON `transferencia_clientes_itens` FOR EACH ROW BEGIN&#013;&#010;  update clientes set OPERADOR = (select OPERADOR_ORIGEM from transferencia_clientes where CODIGO = old.CODIGO)&#013;&#010;  where CODIGO = old.CLIENTE;"/><ROW RowState="6" CODIGO="261" DATA="20170223" SQL="CREATE TRIGGER `tg_transferencia_cli_new` AFTER INSERT ON `transferencia_clientes_itens` FOR EACH ROW BEGIN&#013;&#010;  update clientes set OPERADOR = (select OPERADOR_DESTINO from transferencia_clientes where CODIGO = new.CODIGO)&#013;&#010;  where CODIGO = new.CLIENTE;"/><ROW RowState="14" CODIGO="256" DATA="20170223" SQL="CREATE DEFINER=`root`@`localhost` PROCEDURE `PR_ATUALIZA_DT_ULT_COMPRA_CLI`()&#013;&#010;BEGIN&#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;INNER JOIN&#013;&#010;&#009;campanhas_clientes CC ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;INNER JOIN&#013;&#010;&#009;resultados R ON (R.CODIGO = CC.RESULTADO)&#013;&#010;SET&#013;&#010;&#009;CC.OPERADOR = 0,&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &lt;&gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2)&#013;&#010;&#009;AND R.COD_ACAO &lt;&gt; 8&#013;&#010;&#009;AND (CLI.DATA_ULT_COMPRA &lt; DATE_SUB(NOW(), INTERVAL (SELECT INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY)&#013;&#010;&#009;&#009;  OR CLI.DATA_ULT_COMPRA IS NULL)&#013;&#010;        AND (SELECT COALESCE(CARTEIRA_FIXA_OPERADOR,&apos;N&apos;) FROM parametros) &lt;&gt; &apos;S&apos;;&#013;&#010;           &#013;&#010;UPDATE clientes SET OPERADOR = 0 WHERE DATA_ULT_COMPRA IS NULL;&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;campanhas_clientes CC&#013;&#010;&#009;INNER JOIN clientes CLI ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;SET&#013;&#010;&#009;CC.CAMPANHA = @CC := IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND NOW(),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_ANTIGOS&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND DATE_SUB(NOW(), INTERVAL (&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)+1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)-1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE)))),&#013;&#010; &#009;CLI.COD_CAMPANHA = @CC&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2);&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;SET&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.DATA_ULT_COMPRA &lt;= DATE_SUB(NOW(), INTERVAL (SELECT U.INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY)&#013;&#010;AND CLI.OPERADOR &lt;&gt; -2;"/><ROW RowState="14" CODIGO="259" DATA="20170223" SQL="CREATE TRIGGER `tg_transferencia_clientes_del` BEFORE DELETE ON `transferencia_clientes` FOR EACH ROW BEGIN&#013;&#010;  update clientes set OPERADOR = old.OPERADOR_ORIGEM &#013;&#010;  where CODIGO in (select CLIENTE from transferencia_clientes_itens where CODIGO = old.CODIGO);&#013;&#010;"/><ROW RowState="12" CODIGO="250" DATA="20170216" SQL="ALTER TABLE `historico_cli` DROP FOREIGN KEY `FK_HISTO_CLI_CLIENTE`;&#013;&#010;"/><ROW RowState="12" CODIGO="252" DATA="20170223" SQL="ALTER TABLE `historico_cli`  ADD CONSTRAINT `FK_HISTO_CLI_CLIENTE` FOREIGN KEY (`CLIENTE`) REFERENCES `clientes` (`CODIGO`) ON UPDATE CASCADE ON DELETE CASCADE;&#013;&#010;&#013;&#010;"/><ROW RowState="4" CODIGO="262" DATA="20170307" SQL="ALTER TABLE `clientes` ADD COLUMN `OBS_FONE1` VARCHAR(255) NULL DEFAULT NULL AFTER `OPERADOR_LOGIN`,  ADD COLUMN `OBS_FONE2` VARCHAR(255) NULL DEFAULT NULL AFTER `OBS_FONE1`,  ADD COLUMN `OBS_FONE3` VARCHAR(255) NULL DEFAULT NULL AFTER `OBS_FONE2`;"/><ROW RowState="4" CODIGO="263" DATA="20170307" SQL="alter table parametros add LIMITE_AGENDAMENTO_DIA INTEGER; &#013;&#010;"/><ROW RowState="4" CODIGO="264" DATA="20170307" SQL="alter table parametros add BLOQ_LIMITE_AGENDAMENTO_DIA CHAR(1); "/><ROW RowState="4" CODIGO="265" DATA="20170307" SQL="CREATE TABLE TRANSFERENCIA_CLIENTES&#013;&#010;(&#013;&#010;  CODIGO INTEGER NOT NULL AUTO_INCREMENT,&#013;&#010;  DATA_HORA TIMESTAMP NOT NULL DEFAULT NOW(),&#013;&#010;  OPERADOR INTEGER NOT NULL,&#013;&#010;  OPERADOR_ORIGEM INTEGER NOT NULL,  &#013;&#010;  OPERADOR_DESTINO INTEGER NOT NULL,&#013;&#010;  PRIMARY KEY(CODIGO) &#013;&#010;);"/><ROW RowState="4" CODIGO="266" DATA="20170307" SQL="CREATE TABLE TRANSFERENCIA_CLIENTES_ITENS&#013;&#010;(&#013;&#010;  CODIGO INTEGER NOT NULL,&#013;&#010;  CLIENTE INTEGER NOT NULL,&#013;&#010;  PRIMARY KEY(CODIGO, CLIENTE),&#013;&#010;  CONSTRAINT FK_TRANSFERENCIA_CLIENTES_ITENS FOREIGN KEY(CODIGO) &#013;&#010;  REFERENCES TRANSFERENCIA_CLIENTES(CODIGO) ON DELETE CASCADE ON UPDATE CASCADE  &#013;&#010;);"/><ROW RowState="4" CODIGO="267" DATA="20170307" SQL="CREATE TRIGGER `tg_transferencia_clientes_del` BEFORE DELETE ON `transferencia_clientes` FOR EACH ROW BEGIN&#013;&#010;  update clientes set OPERADOR = old.OPERADOR_ORIGEM &#013;&#010;  where CODIGO in (select CLIENTE from transferencia_clientes_itens where CODIGO = old.CODIGO)&#013;&#010;   and OPERADOR = old.OPERADOR_DESTINO;&#013;&#010;        &#013;&#010;  update campanhas_clientes set OPERADOR = old.OPERADOR_ORIGEM &#013;&#010;  where CLIENTE in (select CLIENTE from transferencia_clientes_itens where CODIGO = old.CODIGO)&#013;&#010;   and CONCLUIDO = &apos;NAO&apos; and OPERADOR = old.OPERADOR_DESTINO;"/><ROW RowState="4" CODIGO="268" DATA="20170307" SQL="CREATE TRIGGER `tg_transferencia_cli_del` BEFORE DELETE ON `transferencia_clientes_itens` FOR EACH ROW BEGIN&#013;&#010;  SET @OPERADOR_ORIGEM = 0;&#013;&#010;  SET @OPERADOR_DESTINO = 0;&#013;&#010;  select OPERADOR_ORIGEM, OPERADOR_DESTINO from transferencia_clientes where CODIGO = old.CODIGO&#013;&#010;  INTO @OPERADOR_ORIGEM, @OPERADOR_DESTINO;&#013;&#010;&#013;&#010;  update clientes set OPERADOR = @OPERADOR_ORIGEM&#013;&#010;  where CODIGO = old.CLIENTE AND OPERADOR = @OPERADOR_DESTINO;&#013;&#010;  &#013;&#010;  update campanhas_clientes set OPERADOR = @OPERADOR_ORIGEM&#013;&#010;  where CLIENTE = old.CLIENTE and CONCLUIDO = &apos;NAO&apos; and OPERADOR = @OPERADOR_DESTINO;"/><ROW RowState="4" CODIGO="269" DATA="20170307" SQL="CREATE TRIGGER `tg_transferencia_cli_new` AFTER INSERT ON `transferencia_clientes_itens` FOR EACH ROW BEGIN&#013;&#010;  SET @OPERADOR_ORIGEM = 0;&#013;&#010;  SET @OPERADOR_DESTINO = 0;&#013;&#010;  select OPERADOR_ORIGEM, OPERADOR_DESTINO from transferencia_clientes where CODIGO = new.CODIGO&#013;&#010;  INTO @OPERADOR_ORIGEM, @OPERADOR_DESTINO;&#013;&#010;&#013;&#010;  update clientes set OPERADOR = @OPERADOR_DESTINO&#013;&#010;  where CODIGO = new.CLIENTE and OPERADOR = @OPERADOR_ORIGEM;&#013;&#010;  &#013;&#010;  update campanhas_clientes set OPERADOR = @OPERADOR_DESTINO&#013;&#010;  where CLIENTE = new.CLIENTE and CONCLUIDO = &apos;NAO&apos; and OPERADOR = @OPERADOR_ORIGEM;"/><ROW RowState="5" CODIGO="270" DATA="20170307" SQL=" CREATE TABLE operadores_meta&#013;&#010; (&#013;&#010;   CODIGO INTEGER NOT NULL AUTO_INCREMENT,&#013;&#010;   OPERADOR INTEGER NOT NULL,&#013;&#010;   MES CHAR(2) NOT NULL,&#013;&#010;   ANO INTEGER NOT NULL,&#013;&#010;   VALOR_META FLOAT NOT NULL,   &#013;&#010;   PRIMARY KEY(CODIGO),&#013;&#010;   CONSTRAINT FK_OPERADORES_META FOREIGN KEY(OPERADOR) REFERENCES operadores (CODIGO) ON DELETE CASCADE ON UPDATE CASCADE  &#013;&#010; ); &#013;&#010;&#013;&#010;"/><ROW RowState="4" CODIGO="271" DATA="20170307" SQL="alter table compras add OPERADOR INTEGER;"/><ROW RowState="4" CODIGO="272" DATA="20170307" SQL="ALTER TABLE parametros ADD CARTEIRA_FIXA_OPERADOR CHAR(1);"/><ROW RowState="4" CODIGO="273" DATA="20170307" SQL="ALTER TABLE parametros ADD TEMPO_MINIMO_CONVERSA INTEGER;"/><ROW RowState="4" CODIGO="274" DATA="20170307" SQL="DROP PROCEDURE `PR_ATUALIZA_DT_ULT_COMPRA_CLI;"/><ROW RowState="4" CODIGO="275" DATA="20170307" SQL="CREATE DEFINER=`root`@`localhost` PROCEDURE `PR_ATUALIZA_DT_ULT_COMPRA_CLI`()&#013;&#010;BEGIN&#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;INNER JOIN&#013;&#010;&#009;campanhas_clientes CC ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;INNER JOIN&#013;&#010;&#009;resultados R ON (R.CODIGO = CC.RESULTADO)&#013;&#010;SET&#013;&#010;&#009;CC.OPERADOR = 0,&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &lt;&gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2)&#013;&#010;&#009;AND R.COD_ACAO &lt;&gt; 8&#013;&#010;&#009;AND (CLI.DATA_ULT_COMPRA &lt; DATE_SUB(NOW(), INTERVAL (SELECT INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY)&#013;&#010;&#009;&#009;  OR CLI.DATA_ULT_COMPRA IS NULL)&#013;&#010;        AND (SELECT COALESCE(CARTEIRA_FIXA_OPERADOR,&apos;N&apos;) FROM parametros) &lt;&gt; &apos;S&apos;;&#013;&#010;           &#013;&#010;UPDATE clientes SET OPERADOR = 0 WHERE DATA_ULT_COMPRA IS NULL;&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;campanhas_clientes CC&#013;&#010;&#009;INNER JOIN clientes CLI ON (CC.CLIENTE = CLI.CODIGO)&#013;&#010;SET&#013;&#010;&#009;CC.CAMPANHA = @CC := IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND NOW(),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA BETWEEN DATE_SUB(NOW(), INTERVAL&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT INATIVOS_ANTIGOS&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY) AND DATE_SUB(NOW(), INTERVAL (&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;SELECT INATIVOS_RECENTES&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM unidades U&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE U.CODIGO = CLI.COD_UNIDADE) DAY),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MIN(CODIGO)+1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;IF (CLI.DATA_ULT_COMPRA IS NULL,&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE),&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;(SELECT MAX(CODIGO)-1&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;FROM campanhas C&#013;&#010;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;&#009;WHERE C.UNIDADE = CLI.COD_UNIDADE)))),&#013;&#010; &#009;CLI.COD_CAMPANHA = @CC&#013;&#010;WHERE&#013;&#010;&#009;CLI.COD_UNIDADE &gt; 0&#013;&#010;&#009;AND CC.CONCLUIDO = &quot;NAO&quot;&#013;&#010;&#009;AND NOT CC.AGENDA IN (-250, -200, -100, -2);&#013;&#010;            &#013;&#010;UPDATE&#013;&#010;&#009;clientes CLI&#013;&#010;SET&#013;&#010;&#009;CLI.OPERADOR = 0&#013;&#010;WHERE&#013;&#010;&#009;CLI.DATA_ULT_COMPRA &lt;= DATE_SUB(NOW(), INTERVAL (SELECT U.INATIVOS_RECENTES FROM unidades U WHERE U.CODIGO = CLI.COD_UNIDADE) DAY)&#013;&#010;AND CLI.OPERADOR &lt;&gt; -2;"/><ROW RowState="6" CODIGO="276" DATA="20170307" SQL="ALTER TABLE `clientes` ADD COLUMN `OBS_FONE1` VARCHAR(255) NULL DEFAULT NULL AFTER `OPERADOR_LOGIN`,  ADD COLUMN `OBS_FONE2` VARCHAR(255) NULL DEFAULT NULL AFTER `OBS_FONE1`,  ADD COLUMN `OBS_FONE3` VARCHAR(255) NULL DEFAULT NULL AFTER `OBS_FONE2`;&#013;&#010;"/><ROW RowState="12" CODIGO="270" DATA="20170307" SQL=" CREATE TABLE operadores_meta&#013;&#010; (&#013;&#010;   CODIGO INTEGER NOT NULL AUTO_INCREMENT,&#013;&#010;   OPERADOR INTEGER NOT NULL,&#013;&#010;   MES CHAR(2) NOT NULL,&#013;&#010;   ANO INTEGER NOT NULL,&#013;&#010;   VALOR_META FLOAT NOT NULL,   &#013;&#010;   PRIMARY KEY(CODIGO),&#013;&#010;   CONSTRAINT FK_OPERADORES_META FOREIGN KEY(OPERADOR) REFERENCES operadores (CODIGO) ON DELETE CASCADE ON UPDATE CASCADE  &#013;&#010; ); &#013;&#010;"/><ROW RowState="12" CODIGO="244" DATA="20170102" SQL="ALTER TABLE parametros add ATIVO_ALTERAR_RAZAO CHAR(1);"/><ROW RowState="5" CODIGO="277" DATA="20170316" SQL="CREATE TABLE operadores_status&#013;&#010;(&#013;&#010;  OPERADOR INTEGER NOT NULL PRIMARY KEY,&#013;&#010;  STATUS_ATUAL CHAR(1),&#013;&#010;  TEMPO TIME,&#013;&#010;  CONSTRAINT FK_OPERADORES_STATUS FOREIGN KEY(OPERADOR) REFERENCES operadores(CODIGO) ON DELETE CASCADE ON UPDATE CASCADE &#013;&#010;);&#013;&#010;&#013;&#010;&#013;&#010;"/><ROW RowState="4" CODIGO="278" DATA="20170316" SQL="create view v_operadores_status as&#013;&#010;select &#013;&#010;  a.OPERADOR, IF(a.STATUS_ATUAL = &apos;0&apos;,&apos;OFF Line&apos;,if(a.STATUS_ATUAL = &apos;1&apos;,&apos;Discando&apos;,&#013;&#010;  if(a.STATUS_ATUAL = &apos;2&apos;,&apos;Em Conversação&apos;,if(a.STATUS_ATUAL = &apos;3&apos;,&apos;Em Pausa&apos;,&#013;&#010;  if(a.STATUS_ATUAL = &apos;4&apos;,&apos;Disponivel&apos;,&apos;&apos;))))) as STATUS_ATUAL, a.TEMPO,&#013;&#010;  b.NOME&#013;&#010;from operadores_status a&#013;&#010;inner join operadores b on b.CODIGO = a.OPERADOR&#013;&#010;WHERE b.ATIVO = &apos;SIM&apos;;"/><ROW RowState="4" CODIGO="279" DATA="20170316" SQL="create table operadores_foto&#013;&#010;(&#013;&#010;  OPERADOR INTEGER NOT NULL PRIMARY KEY,&#013;&#010;  FOTO BLOB,&#013;&#010;  CONSTRAINT FK_OPERADORES_FOTO FOREIGN KEY(OPERADOR) REFERENCES operadores(CODIGO) on delete cascade on update cascade&#013;&#010;);"/><ROW RowState="5" CODIGO="280" DATA="20170321" SQL="&#010;DROP procedure IF EXISTS `PR_REPOE_LIGACOES_FIDELIZADAS`;"/><ROW RowState="12" CODIGO="280" DATA="20170321" SQL="DROP procedure IF EXISTS `PR_REPOE_LIGACOES_FIDELIZADAS`;"/><ROW RowState="5" CODIGO="281" DATA="20170321" SQL="CREATE DEFINER=`root`@`localhost` PROCEDURE `PR_REPOE_LIGACOES_FIDELIZADAS`(IN `VCLIENTE` INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE VCOD_ACAO INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE VATIVO VARCHAR(3);    &#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT distinct      &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;OPERADOR_LIGACAO,&#013;&#010;&#009;r.COD_ACAO, o.ATIVO&#009;&#009;&#009;    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;      &#009;operadores o&#009;&#009;&#009;           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;&#009;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;       &#009;AND r.ECONTATO = &apos;SIM&apos; &#009;&#009;&#009;   &#009;&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR, VCOD_ACAO, VATIVO;&#009;&#013;&#010;&#009;&#009;IF (VFIDELIZA = &quot;SIM&quot;) AND (VCOD_ACAO &lt;&gt; 1) THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = IF(VATIVO = &apos;SIM&apos;, VOPERADOR, IF(VOPERADOR = OPERADOR,0,OPERADOR))   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;            AND OPERADOR &lt;&gt; -2&#013;&#010;            AND AGENDA NOT IN (-250,-260, -270, -240)&#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;"/><ROW RowState="13" CODIGO="281" DATA="20170321" SQL="DELIMITER $$&#013;&#010;CREATE DEFINER=`root`@`localhost` PROCEDURE `PR_REPOE_LIGACOES_FIDELIZADAS`(IN `VCLIENTE` INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE VCOD_ACAO INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE VATIVO VARCHAR(3);    &#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT distinct      &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;OPERADOR_LIGACAO,&#013;&#010;&#009;r.COD_ACAO, o.ATIVO&#009;&#009;&#009;    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;      &#009;operadores o&#009;&#009;&#009;           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;&#009;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;       &#009;AND r.ECONTATO = &apos;SIM&apos; &#009;&#009;&#009;   &#009;&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR, VCOD_ACAO, VATIVO;&#009;&#013;&#010;&#009;&#009;IF (VFIDELIZA = &quot;SIM&quot;) AND (VCOD_ACAO &lt;&gt; 1) THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = IF(VATIVO = &apos;SIM&apos;, VOPERADOR, IF(VOPERADOR = OPERADOR,0,OPERADOR))   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;            AND OPERADOR &lt;&gt; -2&#013;&#010;            AND AGENDA NOT IN (-250,-260, -270, -240)&#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;&#013;&#010;&#013;&#010;END$$&#013;&#010;DELIMITER ;"/><ROW RowState="12" CODIGO="281" DATA="20170321" SQL="CREATE DEFINER=`root`@`localhost` PROCEDURE `PR_REPOE_LIGACOES_FIDELIZADAS`(IN `VCLIENTE` INT)&#013;&#010;BEGIN&#013;&#010;  DECLARE VOPERADOR INT;&#013;&#010;  DECLARE VCOD_ACAO INT;&#013;&#010;  DECLARE SAI INT DEFAULT 0;&#013;&#010;  DECLARE VFIDELIZA VARCHAR(3);&#013;&#010;  DECLARE VATIVO VARCHAR(3);    &#013;&#010;  DECLARE C_FIDELIZA CURSOR FOR&#013;&#010;      (SELECT distinct      &#013;&#010;      &#009;r.FIDELIZARCOTACAO,    &#013;&#010;      &#009;OPERADOR_LIGACAO,&#013;&#010;&#009;r.COD_ACAO, o.ATIVO&#009;&#009;&#009;    &#013;&#010;      FROM                     &#013;&#010;      &#009;campanhas_clientes cc, &#013;&#010;      &#009;resultados r,&#013;&#010;      &#009;operadores o&#009;&#009;&#009;           &#013;&#010;      WHERE                     &#013;&#010;      &#009;r.CODIGO = cc.RESULTADO&#013;&#010;&#009;&#009;&#009;AND cc.OPERADOR_LIGACAO = o.CODIGO  &#013;&#010;       &#009;AND cc.CLIENTE = VCLIENTE&#013;&#010;       &#009;AND r.ECONTATO = &apos;SIM&apos; &#009;&#009;&#009;   &#009;&#013;&#010;      ORDER BY                   &#013;&#010;      &#009;cc.DATA_HORA_LIG DESC    &#013;&#010;      LIMIT 5);&#013;&#010;&#009;DECLARE CONTINUE HANDLER FOR NOT FOUND SET SAI = 1;&#013;&#010;        &#013;&#010;  OPEN C_FIDELIZA;&#013;&#010;   &#013;&#010;&#009;C_FIDELIZA_LOOP:LOOP&#013;&#010;&#009;&#009;FETCH C_FIDELIZA INTO VFIDELIZA, VOPERADOR, VCOD_ACAO, VATIVO;&#009;&#013;&#010;&#009;&#009;IF (VFIDELIZA = &quot;SIM&quot;) AND (VCOD_ACAO &lt;&gt; 1) THEN&#013;&#010;&#009;&#009;&#009;UPDATE        &#013;&#010;&#009;&#009;&#009;&#009;campanhas_clientes     &#013;&#010;&#009;&#009;&#009;SET                      &#013;&#010;&#009;&#009;&#009; &#009;OPERADOR = IF(VATIVO = &apos;SIM&apos;, VOPERADOR, IF(VOPERADOR = OPERADOR,0,OPERADOR))   &#013;&#010;&#009;&#009;&#009;WHERE                    &#013;&#010;&#009;&#009;&#009; &#009;CLIENTE = VCLIENTE     &#013;&#010;&#009;&#009;&#009;&#009;AND CONCLUIDO = &quot;NAO&quot; &#013;&#010;            AND OPERADOR &lt;&gt; -2&#013;&#010;            AND AGENDA NOT IN (-250,-260, -270, -240)&#013;&#010;&#009;&#009;&#009;ORDER BY               &#013;&#010;&#009;&#009;&#009;&#009;CODIGO DESC         &#013;&#010;&#009;&#009;&#009;LIMIT 1;&#013;&#010;&#009;&#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;&#009;&#009;END IF;&#013;&#010;&#009;&#009;IF SAI = 1 THEN&#013;&#010;         &#009;&#009;LEAVE C_FIDELIZA_LOOP;&#013;&#010;      &#009;&#009;END IF;&#009;&#009;&#013;&#010;&#009;END LOOP C_FIDELIZA_LOOP;&#013;&#010;  CLOSE C_FIDELIZA;"/><ROW RowState="13" CODIGO="277" DATA="20170316" SQL="CREATE TABLE operadores_status&#013;&#010;(&#013;&#010;  OPERADOR INTEGER NOT NULL PRIMARY KEY,&#013;&#010;  STATUS_ATUAL CHAR(1),&#013;&#010;  TEMPO TIME,&#013;&#010;  CONSTRAINT FK_OPERADORES_STATUS FOREIGN KEY(OPERADOR) REFERENCES operadores(CODIGO) ON DELETE CASCADE ON UPDATE CASCADE &#013;&#010;);&#013;&#010;&#013;&#010;&#013;&#010;CREATE TABLE operadores_status&#013;&#010;(&#013;&#010;  OPERADOR INTEGER NOT NULL PRIMARY KEY,&#013;&#010;  STATUS_ATUAL CHAR(1),&#013;&#010;  TEMPO TIME,&#013;&#010;  CONSTRAINT FK_OPERADORES_STATUS FOREIGN KEY(OPERADOR) REFERENCES operadores(CODIGO) ON DELETE CASCADE ON UPDATE CASCADE &#013;&#010;);&#013;&#010;&#013;&#010;&#013;&#010;create view v_operadores_status as&#013;&#010;select &#013;&#010;  a.OPERADOR, IF(a.STATUS_ATUAL = &apos;0&apos;,&apos;OFF Line&apos;,if(a.STATUS_ATUAL = &apos;1&apos;,&apos;Discando&apos;,&#013;&#010;  if(a.STATUS_ATUAL = &apos;2&apos;,&apos;Em Conversação&apos;,if(a.STATUS_ATUAL = &apos;3&apos;,&apos;Em Pausa&apos;,&#013;&#010;  if(a.STATUS_ATUAL = &apos;4&apos;,&apos;Disponivel&apos;,&apos;&apos;))))) as STATUS_ATUAL, a.TEMPO,&#013;&#010;  b.NOME&#013;&#010;from operadores_status a&#013;&#010;inner join operadores b on b.CODIGO = a.OPERADOR&#013;&#010;WHERE b.ATIVO = &apos;SIM&apos;;&#013;&#010;&#013;&#010;create table operadores_foto&#013;&#010;(&#013;&#010;  OPERADOR INTEGER NOT NULL PRIMARY KEY,&#013;&#010;  FOTO BLOB,&#013;&#010;  CONSTRAINT FK_OPERADORES_FOTO FOREIGN KEY(OPERADOR) REFERENCES operadores(CODIGO) on delete cascade on update cascade&#013;&#010;);&#013;&#010;&#013;&#010;"/><ROW RowState="12" CODIGO="277" DATA="20170316" SQL="CREATE TABLE operadores_status&#013;&#010;(&#013;&#010;  OPERADOR INTEGER NOT NULL PRIMARY KEY,&#013;&#010;  STATUS_ATUAL CHAR(1),&#013;&#010;  TEMPO TIME,&#013;&#010;  CONSTRAINT FK_OPERADORES_STATUS FOREIGN KEY(OPERADOR) REFERENCES operadores(CODIGO) ON DELETE CASCADE ON UPDATE CASCADE &#013;&#010;);&#013;&#010;"/><ROW RowState="4" CODIGO="282" DATA="20170405" SQL="ALTER TABLE parametros &#010;ADD COLUMN `EXIBIR_FASE_CONTATO` CHAR(1) NULL DEFAULT &apos;S&apos; AFTER `TEMPO_MINIMO_CONVERSA`;&#010;"/></ROWDATA></DATAPACKET>